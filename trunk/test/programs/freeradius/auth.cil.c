// SPDX-FileCopyrightText: 2000 Jeff Carneal <jeff@apex.net>
// SPDX-FileCopyrightText: 2000 Miquel van Smoorenburg <miquels@cistron.nl>
// SPDX-FileCopyrightText: 2000 The FreeRADIUS server project
//
// SPDX-License-Identifier: GPL-2.0-or-later

/* Generated by CIL v. 1.3.7 */
/* print_CIL_Input is true */

#line 211 "/usr/lib/gcc/x86_64-linux-gnu/4.4.1/include/stddef.h"
typedef unsigned long size_t;
#line 31 "/usr/include/bits/types.h"
typedef unsigned char __u_char;
#line 149 "/usr/include/bits/types.h"
typedef long __time_t;
#line 35 "/usr/include/sys/types.h"
typedef __u_char u_char;
#line 76 "/usr/include/time.h"
typedef __time_t time_t;
#line 195 "/usr/include/sys/types.h"
typedef signed char int8_t;
#line 50 "/usr/include/bits/pthreadtypes.h"
typedef unsigned long pthread_t;
#line 49 "/usr/include/stdint.h"
typedef unsigned char uint8_t;
#line 50 "/usr/include/stdint.h"
typedef unsigned short uint16_t;
#line 52 "/usr/include/stdint.h"
typedef unsigned int uint32_t;
#line 141 "/usr/include/netinet/in.h"
typedef uint32_t in_addr_t;
#line 142 "/usr/include/netinet/in.h"
struct in_addr {
   in_addr_t s_addr ;
};
#line 198 "/usr/include/netinet/in.h"
union __anonunion___in6_u_24 {
   uint8_t __u6_addr8[16] ;
   uint16_t __u6_addr16[8] ;
   uint32_t __u6_addr32[4] ;
};
#line 198 "/usr/include/netinet/in.h"
struct in6_addr {
   union __anonunion___in6_u_24 __in6_u ;
};
#line 26 "../include/token.h"
enum lrad_token_t {
    T_OP_INVALID = 0,
    T_EOL = 1,
    T_LCBRACE = 2,
    T_RCBRACE = 3,
    T_LBRACE = 4,
    T_RBRACE = 5,
    T_COMMA = 6,
    T_SEMICOLON = 7,
    T_OP_ADD = 8,
    T_OP_SUB = 9,
    T_OP_SET = 10,
    T_OP_EQ = 11,
    T_OP_NE = 12,
    T_OP_GE = 13,
    T_OP_GT = 14,
    T_OP_LE = 15,
    T_OP_LT = 16,
    T_OP_REG_EQ = 17,
    T_OP_REG_NE = 18,
    T_OP_CMP_TRUE = 19,
    T_OP_CMP_FALSE = 20,
    T_OP_CMP_EQ = 21,
    T_HASH = 22,
    T_BARE_WORD = 23,
    T_DOUBLE_QUOTED_STRING = 24,
    T_SINGLE_QUOTED_STRING = 25,
    T_BACK_QUOTED_STRING = 26,
    T_TOKEN_LAST = 27
} ;
#line 26 "../include/token.h"
typedef enum lrad_token_t LRAD_TOKEN;
#line 108 "../include/libradius.h"
struct attr_flags {
   unsigned int addport : 1 ;
   unsigned int has_tag : 1 ;
   unsigned int do_xlat : 1 ;
   unsigned int caseless : 1 ;
   int8_t tag ;
   uint8_t encrypt ;
};
#line 108 "../include/libradius.h"
typedef struct attr_flags ATTR_FLAGS;
#line 133 "../include/libradius.h"
struct dict_value {
   int attr ;
   int value ;
   char name[1] ;
};
#line 133 "../include/libradius.h"
typedef struct dict_value DICT_VALUE;
#line 144 "../include/libradius.h"
struct value_pair {
   char name[40] ;
   int attribute ;
   int type ;
   int length ;
   uint32_t lvalue ;
   LRAD_TOKEN operator ;
   uint8_t strvalue[254] ;
   ATTR_FLAGS flags ;
   struct value_pair *next ;
};
#line 144 "../include/libradius.h"
typedef struct value_pair VALUE_PAIR;
#line 157 "../include/libradius.h"
union __anonunion_ipaddr_31 {
   struct in_addr ip4addr ;
   struct in6_addr ip6addr ;
};
#line 157 "../include/libradius.h"
struct lrad_ipaddr_t {
   int af ;
   union __anonunion_ipaddr_31 ipaddr ;
};
#line 157 "../include/libradius.h"
typedef struct lrad_ipaddr_t lrad_ipaddr_t;
#line 175 "../include/libradius.h"
struct radius_packet {
   int sockfd ;
   lrad_ipaddr_t src_ipaddr ;
   lrad_ipaddr_t dst_ipaddr ;
   uint16_t src_port ;
   uint16_t dst_port ;
   int id ;
   unsigned int code ;
   uint8_t vector[16] ;
   time_t timestamp ;
   int verified ;
   uint8_t *data ;
   int data_len ;
   VALUE_PAIR *vps ;
};
#line 175 "../include/libradius.h"
typedef struct radius_packet RADIUS_PACKET;
#line 19 "../include/conffile.h"
struct conf_part;
#line 19 "../include/conffile.h"
typedef struct conf_part CONF_SECTION;
#line 24 "../include/radiusd.h"
typedef pthread_t child_pid_t;
#line 49
struct request_data_t;
#line 49 "../include/radiusd.h"
typedef struct request_data_t request_data_t;
#line 54
struct rad_listen_t;
#line 54 "../include/radiusd.h"
typedef struct rad_listen_t rad_listen_t;
#line 59
struct request_list_t;
#line 59 "../include/radiusd.h"
typedef struct request_list_t request_list_t;
#line 64 "../include/radiusd.h"
struct auth_req {
   uint32_t magic ;
   RADIUS_PACKET *packet ;
   RADIUS_PACKET *proxy ;
   RADIUS_PACKET *reply ;
   RADIUS_PACKET *proxy_reply ;
   VALUE_PAIR *config_items ;
   VALUE_PAIR *username ;
   VALUE_PAIR *password ;
   request_data_t *data ;
   char secret[32] ;
   child_pid_t child_pid ;
   time_t timestamp ;
   int number ;
   rad_listen_t *listener ;
   rad_listen_t *proxy_listener ;
   char proxysecret[32] ;
   int proxy_try_count ;
   int proxy_outstanding ;
   time_t proxy_start_time ;
   int simul_max ;
   int simul_count ;
   int simul_mpp ;
   int finished ;
   int options ;
   char const   *module ;
   char const   *component ;
   void *container ;
};
#line 64 "../include/radiusd.h"
typedef struct auth_req REQUEST;
#line 120 "../include/radiusd.h"
typedef int (*RAD_REQUEST_FUNP)(REQUEST * );
#line 134
struct radclient_list;
#line 134 "../include/radiusd.h"
typedef struct radclient_list RADCLIENT_LIST;
#line 136 "../include/radiusd.h"
struct _realm {
   char realm[64] ;
   char server[64] ;
   char acct_server[64] ;
   lrad_ipaddr_t ipaddr ;
   lrad_ipaddr_t acct_ipaddr ;
   u_char secret[32] ;
   time_t last_reply ;
   int auth_port ;
   int acct_port ;
   int striprealm ;
   int trusted ;
   int notrealm ;
   int active ;
   time_t wakeup ;
   int acct_active ;
   time_t acct_wakeup ;
   int ldflag ;
   struct _realm *next ;
};
#line 136 "../include/radiusd.h"
typedef struct _realm REALM;
#line 172
enum RAD_LISTEN_TYPE {
    RAD_LISTEN_NONE = 0,
    RAD_LISTEN_AUTH = 1,
    RAD_LISTEN_ACCT = 2,
    RAD_LISTEN_PROXY = 3,
    RAD_LISTEN_DETAIL = 4,
    RAD_LISTEN_MAX = 5
} ;
#line 172 "../include/radiusd.h"
typedef enum RAD_LISTEN_TYPE RAD_LISTEN_TYPE;
#line 186 "../include/radiusd.h"
struct rad_listen_t {
   struct rad_listen_t *next ;
   RAD_LISTEN_TYPE type ;
   int fd ;
   char const   *identity ;
   request_list_t *rl ;
   int (*recv)(rad_listen_t * , RAD_REQUEST_FUNP * , REQUEST ** ) ;
   int (*send)(rad_listen_t * , REQUEST * ) ;
   int (*update)(rad_listen_t * , time_t  ) ;
   int (*print)(rad_listen_t * , char * , size_t  ) ;
   void *data ;
};
#line 205
enum radlog_dest_t {
    RADLOG_STDOUT = 0,
    RADLOG_FILES = 1,
    RADLOG_SYSLOG = 2,
    RADLOG_STDERR = 3,
    RADLOG_NULL = 4
} ;
#line 205 "../include/radiusd.h"
typedef enum radlog_dest_t radlog_dest_t;
#line 213
struct main_config;
#line 213 "../include/radiusd.h"
struct main_config_t {
   struct main_config *next ;
   time_t config_dead_time ;
   lrad_ipaddr_t myip ;
   int port ;
   int log_auth ;
   int log_auth_badpass ;
   int log_auth_goodpass ;
   int allow_core_dumps ;
   int debug_level ;
   int proxy_requests ;
   int wake_all_if_all_dead ;
   int proxy_synchronous ;
   int proxy_dead_time ;
   int proxy_retry_count ;
   int proxy_retry_delay ;
   int proxy_fallback ;
   char const   *proxy_fail_type ;
   int reject_delay ;
   int status_server ;
   int max_request_time ;
   int cleanup_delay ;
   int max_requests ;
   int kill_unresponsive_children ;
   char *log_file ;
   char *checkrad ;
   char const   *pid_file ;
   char const   *uid_name ;
   char const   *gid_name ;
   rad_listen_t *listen ;
   int syslog_facility ;
   int radlog_fd ;
   radlog_dest_t radlog_dest ;
   CONF_SECTION *config ;
   RADCLIENT_LIST *clients ;
   REALM *realms ;
   char const   *radiusd_conf ;
};
#line 543 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__, __noreturn__)) void exit(int __status ) ;
#line 67 "/usr/include/string.h"
extern  __attribute__((__nothrow__)) int memcmp(void const   *__s1 , void const   *__s2 ,
                                                size_t __n )  __attribute__((__pure__,
__nonnull__(1,2))) ;
#line 127
extern  __attribute__((__nothrow__)) char *strcpy(char * __restrict  __dest , char const   * __restrict  __src )  __attribute__((__nonnull__(1,2))) ;
#line 142
extern  __attribute__((__nothrow__)) int strcmp(char const   *__s1 , char const   *__s2 )  __attribute__((__pure__,
__nonnull__(1,2))) ;
#line 81 "/usr/include/ctype.h"
extern  __attribute__((__nothrow__)) unsigned short const   **__ctype_b_loc(void)  __attribute__((__const__)) ;
#line 365 "/usr/include/netinet/in.h"
extern  __attribute__((__nothrow__)) uint32_t ntohl(uint32_t __netlong )  __attribute__((__const__)) ;
#line 368
extern  __attribute__((__nothrow__)) uint32_t htonl(uint32_t __hostlong )  __attribute__((__const__)) ;
#line 363 "/usr/include/stdio.h"
extern  __attribute__((__nothrow__)) int ( /* format attribute */  snprintf)(char * __restrict  __s ,
                                                                             size_t __maxlen ,
                                                                             char const   * __restrict  __format 
                                                                             , ...) ;
#line 194 "../include/libradius.h"
extern void librad_safeprint(char *in , int inlen , char *out , int outlen ) ;
#line 211
extern DICT_VALUE *dict_valbyattr(int attr , int val ) ;
#line 212
extern DICT_VALUE *dict_valbyname(int attr , char const   *val ) ;
#line 274
extern int rad_chap_encode(RADIUS_PACKET *packet , char *output , int id , VALUE_PAIR *password ) ;
#line 277
extern VALUE_PAIR *paircreate(int attr , int type ) ;
#line 278
extern void pairfree(VALUE_PAIR ** ) ;
#line 280
extern VALUE_PAIR *pairfind(VALUE_PAIR * , int  ) ;
#line 281
extern void pairdelete(VALUE_PAIR ** , int  ) ;
#line 282
extern void pairadd(VALUE_PAIR ** , VALUE_PAIR * ) ;
#line 289
extern VALUE_PAIR *pairmake(char const   *attribute , char const   *value , int operator ) ;
#line 317
extern char const   *ip_ntoa(char * , uint32_t  ) ;
#line 391
extern int lrad_crypt_check(char const   *key , char const   *salt ) ;
#line 309 "../include/radiusd.h"
extern int debug_flag ;
#line 316
extern int log_stripped_names ;
#line 376
extern char const   *client_name_old(lrad_ipaddr_t const   *ipaddr ) ;
#line 379
extern REALM *realm_find(char const   * , int  ) ;
#line 393
extern int ( /* format attribute */  radlog)(int  , char const   *  , ...) ;
#line 398
extern int ( /* format attribute */  log_debug)(char const   *  , ...) ;
#line 410
char *auth_name(char *buf , size_t buflen , REQUEST *request , int do_cli ) ;
#line 411
int rad_authenticate(REQUEST *request ) ;
#line 412
int rad_postauth(REQUEST *request ) ;
#line 460
extern struct main_config_t mainconfig ;
#line 56 "../include/modules.h"
extern int module_authorize(int type , REQUEST *request ) ;
#line 57
extern int module_authenticate(int type , REQUEST *request ) ;
#line 60
extern int module_checksimul(int type , REQUEST *request , int maxsimul ) ;
#line 63
extern int module_post_auth(int type , REQUEST *request ) ;
#line 25 "../include/rad_assert.h"
extern void rad_assert_fail(char const   *file , unsigned int line ) ;
#line 45 "auth.c"
char *auth_name(char *buf , size_t buflen , REQUEST *request , int do_cli ) 
{ VALUE_PAIR *cli ;
  VALUE_PAIR *pair ;
  int port ;
  char const   *tmp ;
  char const   *tmp___0 ;
  char const   *tmp___1 ;
  unsigned long __cil_tmp11 ;
  unsigned long __cil_tmp12 ;
  RADIUS_PACKET *__cil_tmp13 ;
  unsigned long __cil_tmp14 ;
  unsigned long __cil_tmp15 ;
  VALUE_PAIR *__cil_tmp16 ;
  void *__cil_tmp17 ;
  unsigned long __cil_tmp18 ;
  unsigned long __cil_tmp19 ;
  unsigned long __cil_tmp20 ;
  unsigned long __cil_tmp21 ;
  RADIUS_PACKET *__cil_tmp22 ;
  unsigned long __cil_tmp23 ;
  unsigned long __cil_tmp24 ;
  VALUE_PAIR *__cil_tmp25 ;
  void *__cil_tmp26 ;
  unsigned long __cil_tmp27 ;
  unsigned long __cil_tmp28 ;
  unsigned long __cil_tmp29 ;
  unsigned long __cil_tmp30 ;
  uint32_t __cil_tmp31 ;
  unsigned long __cil_tmp32 ;
  unsigned long __cil_tmp33 ;
  unsigned long __cil_tmp34 ;
  unsigned long __cil_tmp35 ;
  uint8_t *__cil_tmp36 ;
  char *__cil_tmp37 ;
  unsigned long __cil_tmp38 ;
  unsigned long __cil_tmp39 ;
  RADIUS_PACKET *__cil_tmp40 ;
  unsigned long __cil_tmp41 ;
  unsigned long __cil_tmp42 ;
  lrad_ipaddr_t *__cil_tmp43 ;
  lrad_ipaddr_t const   *__cil_tmp44 ;
  char * __restrict  __cil_tmp45 ;
  char const   * __restrict  __cil_tmp46 ;
  RADIUS_PACKET **mem_47 ;
  VALUE_PAIR **mem_48 ;
  RADIUS_PACKET **mem_49 ;
  VALUE_PAIR **mem_50 ;
  uint32_t *mem_51 ;
  RADIUS_PACKET **mem_52 ;

  {
  {
#line 48
  port = 0;
#line 50
  __cil_tmp11 = (unsigned long )request;
#line 50
  __cil_tmp12 = __cil_tmp11 + 8;
#line 50
  mem_47 = (RADIUS_PACKET **)__cil_tmp12;
#line 50
  __cil_tmp13 = *mem_47;
#line 50
  __cil_tmp14 = (unsigned long )__cil_tmp13;
#line 50
  __cil_tmp15 = __cil_tmp14 + 104;
#line 50
  mem_48 = (VALUE_PAIR **)__cil_tmp15;
#line 50
  __cil_tmp16 = *mem_48;
#line 50
  cli = pairfind(__cil_tmp16, 31);
  }
  {
#line 50
  __cil_tmp17 = (void *)0;
#line 50
  __cil_tmp18 = (unsigned long )__cil_tmp17;
#line 50
  __cil_tmp19 = (unsigned long )cli;
#line 50
  if (__cil_tmp19 == __cil_tmp18) {
#line 51
    do_cli = 0;
  } else {

  }
  }
  {
#line 52
  __cil_tmp20 = (unsigned long )request;
#line 52
  __cil_tmp21 = __cil_tmp20 + 8;
#line 52
  mem_49 = (RADIUS_PACKET **)__cil_tmp21;
#line 52
  __cil_tmp22 = *mem_49;
#line 52
  __cil_tmp23 = (unsigned long )__cil_tmp22;
#line 52
  __cil_tmp24 = __cil_tmp23 + 104;
#line 52
  mem_50 = (VALUE_PAIR **)__cil_tmp24;
#line 52
  __cil_tmp25 = *mem_50;
#line 52
  pair = pairfind(__cil_tmp25, 5);
  }
  {
#line 52
  __cil_tmp26 = (void *)0;
#line 52
  __cil_tmp27 = (unsigned long )__cil_tmp26;
#line 52
  __cil_tmp28 = (unsigned long )pair;
#line 52
  if (__cil_tmp28 != __cil_tmp27) {
#line 53
    __cil_tmp29 = (unsigned long )pair;
#line 53
    __cil_tmp30 = __cil_tmp29 + 52;
#line 53
    mem_51 = (uint32_t *)__cil_tmp30;
#line 53
    __cil_tmp31 = *mem_51;
#line 53
    port = (int )__cil_tmp31;
  } else {

  }
  }
#line 55
  if (do_cli) {
#line 55
    __cil_tmp32 = 0 * 1UL;
#line 55
    __cil_tmp33 = 88 + __cil_tmp32;
#line 55
    __cil_tmp34 = (unsigned long )cli;
#line 55
    __cil_tmp35 = __cil_tmp34 + __cil_tmp33;
#line 55
    __cil_tmp36 = (uint8_t *)__cil_tmp35;
#line 55
    __cil_tmp37 = (char *)__cil_tmp36;
#line 55
    tmp = (char const   *)__cil_tmp37;
  } else {
#line 55
    tmp = "";
  }
#line 55
  if (do_cli) {
#line 55
    tmp___0 = " cli ";
  } else {
#line 55
    tmp___0 = "";
  }
  {
#line 55
  __cil_tmp38 = (unsigned long )request;
#line 55
  __cil_tmp39 = __cil_tmp38 + 8;
#line 55
  mem_52 = (RADIUS_PACKET **)__cil_tmp39;
#line 55
  __cil_tmp40 = *mem_52;
#line 55
  __cil_tmp41 = (unsigned long )__cil_tmp40;
#line 55
  __cil_tmp42 = __cil_tmp41 + 4;
#line 55
  __cil_tmp43 = (lrad_ipaddr_t *)__cil_tmp42;
#line 55
  __cil_tmp44 = (lrad_ipaddr_t const   *)__cil_tmp43;
#line 55
  tmp___1 = client_name_old(__cil_tmp44);
#line 55
  __cil_tmp45 = (char * __restrict  )buf;
#line 55
  __cil_tmp46 = (char const   * __restrict  )"from client %.128s port %u%s%.128s";
#line 55
  snprintf(__cil_tmp45, buflen, __cil_tmp46, tmp___1, port, tmp___0, tmp);
  }
#line 59
  return (buf);
}
}
#line 68 "auth.c"
static int rad_authlog(char const   *msg , REQUEST *request , int goodpass ) 
{ char clean_password[1024] ;
  char clean_username[1024] ;
  char buf[1024] ;
  VALUE_PAIR *username ;
  VALUE_PAIR *auth_type ;
  char *tmp ;
  char const   *tmp___0 ;
  char const   *tmp___1 ;
  char *tmp___2 ;
  char const   *tmp___3 ;
  char const   *tmp___4 ;
  void *__cil_tmp15 ;
  unsigned long __cil_tmp16 ;
  unsigned long __cil_tmp17 ;
  RADIUS_PACKET *__cil_tmp18 ;
  unsigned long __cil_tmp19 ;
  unsigned long __cil_tmp20 ;
  VALUE_PAIR *__cil_tmp21 ;
  unsigned long __cil_tmp22 ;
  unsigned long __cil_tmp23 ;
  void *__cil_tmp24 ;
  unsigned long __cil_tmp25 ;
  unsigned long __cil_tmp26 ;
  unsigned long __cil_tmp27 ;
  unsigned long __cil_tmp28 ;
  char *__cil_tmp29 ;
  char * __restrict  __cil_tmp30 ;
  char const   * __restrict  __cil_tmp31 ;
  unsigned long __cil_tmp32 ;
  unsigned long __cil_tmp33 ;
  unsigned long __cil_tmp34 ;
  unsigned long __cil_tmp35 ;
  uint8_t *__cil_tmp36 ;
  char *__cil_tmp37 ;
  unsigned long __cil_tmp38 ;
  unsigned long __cil_tmp39 ;
  int __cil_tmp40 ;
  unsigned long __cil_tmp41 ;
  unsigned long __cil_tmp42 ;
  char *__cil_tmp43 ;
  int __cil_tmp44 ;
  unsigned long __cil_tmp45 ;
  unsigned long __cil_tmp46 ;
  VALUE_PAIR *__cil_tmp47 ;
  unsigned long __cil_tmp48 ;
  unsigned long __cil_tmp49 ;
  VALUE_PAIR *__cil_tmp50 ;
  unsigned long __cil_tmp51 ;
  unsigned long __cil_tmp52 ;
  unsigned long __cil_tmp53 ;
  unsigned long __cil_tmp54 ;
  uint8_t __cil_tmp55 ;
  int __cil_tmp56 ;
  unsigned long __cil_tmp57 ;
  unsigned long __cil_tmp58 ;
  char *__cil_tmp59 ;
  char * __restrict  __cil_tmp60 ;
  char const   * __restrict  __cil_tmp61 ;
  unsigned long __cil_tmp62 ;
  unsigned long __cil_tmp63 ;
  unsigned long __cil_tmp64 ;
  unsigned long __cil_tmp65 ;
  uint8_t *__cil_tmp66 ;
  unsigned long __cil_tmp67 ;
  unsigned long __cil_tmp68 ;
  char *__cil_tmp69 ;
  char * __restrict  __cil_tmp70 ;
  char const   * __restrict  __cil_tmp71 ;
  unsigned long __cil_tmp72 ;
  unsigned long __cil_tmp73 ;
  char *__cil_tmp74 ;
  char * __restrict  __cil_tmp75 ;
  char const   * __restrict  __cil_tmp76 ;
  unsigned long __cil_tmp77 ;
  unsigned long __cil_tmp78 ;
  VALUE_PAIR *__cil_tmp79 ;
  unsigned long __cil_tmp80 ;
  unsigned long __cil_tmp81 ;
  int __cil_tmp82 ;
  unsigned long __cil_tmp83 ;
  unsigned long __cil_tmp84 ;
  char *__cil_tmp85 ;
  char * __restrict  __cil_tmp86 ;
  char const   * __restrict  __cil_tmp87 ;
  unsigned long __cil_tmp88 ;
  unsigned long __cil_tmp89 ;
  unsigned long __cil_tmp90 ;
  unsigned long __cil_tmp91 ;
  VALUE_PAIR *__cil_tmp92 ;
  unsigned long __cil_tmp93 ;
  unsigned long __cil_tmp94 ;
  uint8_t *__cil_tmp95 ;
  char *__cil_tmp96 ;
  unsigned long __cil_tmp97 ;
  unsigned long __cil_tmp98 ;
  VALUE_PAIR *__cil_tmp99 ;
  unsigned long __cil_tmp100 ;
  unsigned long __cil_tmp101 ;
  int __cil_tmp102 ;
  unsigned long __cil_tmp103 ;
  unsigned long __cil_tmp104 ;
  char *__cil_tmp105 ;
  int __cil_tmp106 ;
  unsigned long __cil_tmp107 ;
  unsigned long __cil_tmp108 ;
  char *__cil_tmp109 ;
  unsigned long __cil_tmp110 ;
  unsigned long __cil_tmp111 ;
  char *__cil_tmp112 ;
  unsigned long __cil_tmp113 ;
  unsigned long __cil_tmp114 ;
  char *__cil_tmp115 ;
  unsigned long __cil_tmp116 ;
  unsigned long __cil_tmp117 ;
  char *__cil_tmp118 ;
  unsigned long __cil_tmp119 ;
  unsigned long __cil_tmp120 ;
  char *__cil_tmp121 ;
  unsigned long __cil_tmp122 ;
  unsigned long __cil_tmp123 ;
  char *__cil_tmp124 ;
  RADIUS_PACKET **mem_125 ;
  VALUE_PAIR **mem_126 ;
  VALUE_PAIR **mem_127 ;
  int *mem_128 ;
  VALUE_PAIR **mem_129 ;
  VALUE_PAIR **mem_130 ;
  uint8_t *mem_131 ;
  VALUE_PAIR **mem_132 ;
  int *mem_133 ;
  VALUE_PAIR **mem_134 ;
  VALUE_PAIR **mem_135 ;
  int *mem_136 ;

  {
#line 73
  __cil_tmp15 = (void *)0;
#line 73
  username = (VALUE_PAIR *)__cil_tmp15;
#line 75
  if (! mainconfig.log_auth) {
#line 76
    return (0);
  } else {

  }
#line 82
  if (log_stripped_names == 0) {
    {
#line 83
    __cil_tmp16 = (unsigned long )request;
#line 83
    __cil_tmp17 = __cil_tmp16 + 8;
#line 83
    mem_125 = (RADIUS_PACKET **)__cil_tmp17;
#line 83
    __cil_tmp18 = *mem_125;
#line 83
    __cil_tmp19 = (unsigned long )__cil_tmp18;
#line 83
    __cil_tmp20 = __cil_tmp19 + 104;
#line 83
    mem_126 = (VALUE_PAIR **)__cil_tmp20;
#line 83
    __cil_tmp21 = *mem_126;
#line 83
    username = pairfind(__cil_tmp21, 1);
    }
  } else {
#line 85
    __cil_tmp22 = (unsigned long )request;
#line 85
    __cil_tmp23 = __cil_tmp22 + 48;
#line 85
    mem_127 = (VALUE_PAIR **)__cil_tmp23;
#line 85
    username = *mem_127;
  }
  {
#line 91
  __cil_tmp24 = (void *)0;
#line 91
  __cil_tmp25 = (unsigned long )__cil_tmp24;
#line 91
  __cil_tmp26 = (unsigned long )username;
#line 91
  if (__cil_tmp26 == __cil_tmp25) {
    {
#line 92
    __cil_tmp27 = 0 * 1UL;
#line 92
    __cil_tmp28 = (unsigned long )(clean_username) + __cil_tmp27;
#line 92
    __cil_tmp29 = (char *)__cil_tmp28;
#line 92
    __cil_tmp30 = (char * __restrict  )__cil_tmp29;
#line 92
    __cil_tmp31 = (char const   * __restrict  )"<no User-Name attribute>";
#line 92
    strcpy(__cil_tmp30, __cil_tmp31);
    }
  } else {
    {
#line 94
    __cil_tmp32 = 0 * 1UL;
#line 94
    __cil_tmp33 = 88 + __cil_tmp32;
#line 94
    __cil_tmp34 = (unsigned long )username;
#line 94
    __cil_tmp35 = __cil_tmp34 + __cil_tmp33;
#line 94
    __cil_tmp36 = (uint8_t *)__cil_tmp35;
#line 94
    __cil_tmp37 = (char *)__cil_tmp36;
#line 94
    __cil_tmp38 = (unsigned long )username;
#line 94
    __cil_tmp39 = __cil_tmp38 + 48;
#line 94
    mem_128 = (int *)__cil_tmp39;
#line 94
    __cil_tmp40 = *mem_128;
#line 94
    __cil_tmp41 = 0 * 1UL;
#line 94
    __cil_tmp42 = (unsigned long )(clean_username) + __cil_tmp41;
#line 94
    __cil_tmp43 = (char *)__cil_tmp42;
#line 94
    __cil_tmp44 = (int )1024UL;
#line 94
    librad_safeprint(__cil_tmp37, __cil_tmp40, __cil_tmp43, __cil_tmp44);
    }
  }
  }
#line 102
  if (mainconfig.log_auth_badpass) {
    goto _L;
  } else {
#line 102
    if (mainconfig.log_auth_goodpass) {
      _L: /* CIL Label */ 
      {
#line 103
      __cil_tmp45 = (unsigned long )request;
#line 103
      __cil_tmp46 = __cil_tmp45 + 56;
#line 103
      mem_129 = (VALUE_PAIR **)__cil_tmp46;
#line 103
      __cil_tmp47 = *mem_129;
#line 103
      if (! __cil_tmp47) {
        {
#line 106
        __cil_tmp48 = (unsigned long )request;
#line 106
        __cil_tmp49 = __cil_tmp48 + 40;
#line 106
        mem_130 = (VALUE_PAIR **)__cil_tmp49;
#line 106
        __cil_tmp50 = *mem_130;
#line 106
        auth_type = pairfind(__cil_tmp50, 1000);
        }
#line 108
        if (auth_type) {
          {
#line 108
          __cil_tmp51 = 0 * 1UL;
#line 108
          __cil_tmp52 = 88 + __cil_tmp51;
#line 108
          __cil_tmp53 = (unsigned long )auth_type;
#line 108
          __cil_tmp54 = __cil_tmp53 + __cil_tmp52;
#line 108
          mem_131 = (uint8_t *)__cil_tmp54;
#line 108
          __cil_tmp55 = *mem_131;
#line 108
          __cil_tmp56 = (int )__cil_tmp55;
#line 108
          if (__cil_tmp56 != 0) {
            {
#line 109
            __cil_tmp57 = 0 * 1UL;
#line 109
            __cil_tmp58 = (unsigned long )(clean_password) + __cil_tmp57;
#line 109
            __cil_tmp59 = (char *)__cil_tmp58;
#line 109
            __cil_tmp60 = (char * __restrict  )__cil_tmp59;
#line 109
            __cil_tmp61 = (char const   * __restrict  )"<via Auth-Type = %s>";
#line 109
            __cil_tmp62 = 0 * 1UL;
#line 109
            __cil_tmp63 = 88 + __cil_tmp62;
#line 109
            __cil_tmp64 = (unsigned long )auth_type;
#line 109
            __cil_tmp65 = __cil_tmp64 + __cil_tmp63;
#line 109
            __cil_tmp66 = (uint8_t *)__cil_tmp65;
#line 109
            snprintf(__cil_tmp60, 1024UL, __cil_tmp61, __cil_tmp66);
            }
          } else {
            {
#line 113
            __cil_tmp67 = 0 * 1UL;
#line 113
            __cil_tmp68 = (unsigned long )(clean_password) + __cil_tmp67;
#line 113
            __cil_tmp69 = (char *)__cil_tmp68;
#line 113
            __cil_tmp70 = (char * __restrict  )__cil_tmp69;
#line 113
            __cil_tmp71 = (char const   * __restrict  )"<no User-Password attribute>";
#line 113
            strcpy(__cil_tmp70, __cil_tmp71);
            }
          }
          }
        } else {
          {
#line 113
          __cil_tmp72 = 0 * 1UL;
#line 113
          __cil_tmp73 = (unsigned long )(clean_password) + __cil_tmp72;
#line 113
          __cil_tmp74 = (char *)__cil_tmp73;
#line 113
          __cil_tmp75 = (char * __restrict  )__cil_tmp74;
#line 113
          __cil_tmp76 = (char const   * __restrict  )"<no User-Password attribute>";
#line 113
          strcpy(__cil_tmp75, __cil_tmp76);
          }
        }
      } else {
        {
#line 115
        __cil_tmp77 = (unsigned long )request;
#line 115
        __cil_tmp78 = __cil_tmp77 + 56;
#line 115
        mem_132 = (VALUE_PAIR **)__cil_tmp78;
#line 115
        __cil_tmp79 = *mem_132;
#line 115
        __cil_tmp80 = (unsigned long )__cil_tmp79;
#line 115
        __cil_tmp81 = __cil_tmp80 + 40;
#line 115
        mem_133 = (int *)__cil_tmp81;
#line 115
        __cil_tmp82 = *mem_133;
#line 115
        if (__cil_tmp82 == 3) {
          {
#line 116
          __cil_tmp83 = 0 * 1UL;
#line 116
          __cil_tmp84 = (unsigned long )(clean_password) + __cil_tmp83;
#line 116
          __cil_tmp85 = (char *)__cil_tmp84;
#line 116
          __cil_tmp86 = (char * __restrict  )__cil_tmp85;
#line 116
          __cil_tmp87 = (char const   * __restrict  )"<CHAP-Password>";
#line 116
          strcpy(__cil_tmp86, __cil_tmp87);
          }
        } else {
          {
#line 118
          __cil_tmp88 = 0 * 1UL;
#line 118
          __cil_tmp89 = 88 + __cil_tmp88;
#line 118
          __cil_tmp90 = (unsigned long )request;
#line 118
          __cil_tmp91 = __cil_tmp90 + 56;
#line 118
          mem_134 = (VALUE_PAIR **)__cil_tmp91;
#line 118
          __cil_tmp92 = *mem_134;
#line 118
          __cil_tmp93 = (unsigned long )__cil_tmp92;
#line 118
          __cil_tmp94 = __cil_tmp93 + __cil_tmp89;
#line 118
          __cil_tmp95 = (uint8_t *)__cil_tmp94;
#line 118
          __cil_tmp96 = (char *)__cil_tmp95;
#line 118
          __cil_tmp97 = (unsigned long )request;
#line 118
          __cil_tmp98 = __cil_tmp97 + 56;
#line 118
          mem_135 = (VALUE_PAIR **)__cil_tmp98;
#line 118
          __cil_tmp99 = *mem_135;
#line 118
          __cil_tmp100 = (unsigned long )__cil_tmp99;
#line 118
          __cil_tmp101 = __cil_tmp100 + 48;
#line 118
          mem_136 = (int *)__cil_tmp101;
#line 118
          __cil_tmp102 = *mem_136;
#line 118
          __cil_tmp103 = 0 * 1UL;
#line 118
          __cil_tmp104 = (unsigned long )(clean_password) + __cil_tmp103;
#line 118
          __cil_tmp105 = (char *)__cil_tmp104;
#line 118
          __cil_tmp106 = (int )1024UL;
#line 118
          librad_safeprint(__cil_tmp96, __cil_tmp102, __cil_tmp105, __cil_tmp106);
          }
        }
        }
      }
      }
    } else {

    }
  }
#line 124
  if (goodpass) {
    {
#line 125
    __cil_tmp107 = 0 * 1UL;
#line 125
    __cil_tmp108 = (unsigned long )(buf) + __cil_tmp107;
#line 125
    __cil_tmp109 = (char *)__cil_tmp108;
#line 125
    tmp = auth_name(__cil_tmp109, 1024UL, request, 1);
    }
#line 125
    if (mainconfig.log_auth_goodpass) {
#line 125
      __cil_tmp110 = 0 * 1UL;
#line 125
      __cil_tmp111 = (unsigned long )(clean_password) + __cil_tmp110;
#line 125
      __cil_tmp112 = (char *)__cil_tmp111;
#line 125
      tmp___0 = (char const   *)__cil_tmp112;
    } else {
#line 125
      tmp___0 = "";
    }
#line 125
    if (mainconfig.log_auth_goodpass) {
#line 125
      tmp___1 = "/";
    } else {
#line 125
      tmp___1 = "";
    }
    {
#line 125
    __cil_tmp113 = 0 * 1UL;
#line 125
    __cil_tmp114 = (unsigned long )(clean_username) + __cil_tmp113;
#line 125
    __cil_tmp115 = (char *)__cil_tmp114;
#line 125
    radlog(2, "%s: [%s%s%s] (%s)", msg, __cil_tmp115, tmp___1, tmp___0, tmp);
    }
  } else {
    {
#line 132
    __cil_tmp116 = 0 * 1UL;
#line 132
    __cil_tmp117 = (unsigned long )(buf) + __cil_tmp116;
#line 132
    __cil_tmp118 = (char *)__cil_tmp117;
#line 132
    tmp___2 = auth_name(__cil_tmp118, 1024UL, request, 1);
    }
#line 132
    if (mainconfig.log_auth_badpass) {
#line 132
      __cil_tmp119 = 0 * 1UL;
#line 132
      __cil_tmp120 = (unsigned long )(clean_password) + __cil_tmp119;
#line 132
      __cil_tmp121 = (char *)__cil_tmp120;
#line 132
      tmp___3 = (char const   *)__cil_tmp121;
    } else {
#line 132
      tmp___3 = "";
    }
#line 132
    if (mainconfig.log_auth_badpass) {
#line 132
      tmp___4 = "/";
    } else {
#line 132
      tmp___4 = "";
    }
    {
#line 132
    __cil_tmp122 = 0 * 1UL;
#line 132
    __cil_tmp123 = (unsigned long )(clean_username) + __cil_tmp122;
#line 132
    __cil_tmp124 = (char *)__cil_tmp123;
#line 132
    radlog(2, "%s: [%s%s%s] (%s)", msg, __cil_tmp124, tmp___4, tmp___3, tmp___2);
    }
  }
#line 140
  return (0);
}
}
#line 153 "auth.c"
static int rad_check_password(REQUEST *request ) 
{ VALUE_PAIR *auth_type_pair ;
  VALUE_PAIR *cur_config_item ;
  VALUE_PAIR *password_pair ;
  VALUE_PAIR *auth_item ;
  char string[254] ;
  int auth_type ;
  int result ;
  int auth_type_count ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  DICT_VALUE *tmp___2 ;
  unsigned long __cil_tmp14 ;
  unsigned long __cil_tmp15 ;
  void *__cil_tmp16 ;
  unsigned long __cil_tmp17 ;
  unsigned long __cil_tmp18 ;
  unsigned long __cil_tmp19 ;
  unsigned long __cil_tmp20 ;
  uint32_t __cil_tmp21 ;
  unsigned long __cil_tmp22 ;
  unsigned long __cil_tmp23 ;
  unsigned long __cil_tmp24 ;
  unsigned long __cil_tmp25 ;
  uint8_t *__cil_tmp26 ;
  unsigned long __cil_tmp27 ;
  unsigned long __cil_tmp28 ;
  unsigned long __cil_tmp29 ;
  unsigned long __cil_tmp30 ;
  unsigned long __cil_tmp31 ;
  unsigned long __cil_tmp32 ;
  VALUE_PAIR *__cil_tmp33 ;
  unsigned long __cil_tmp34 ;
  unsigned long __cil_tmp35 ;
  uint8_t *__cil_tmp36 ;
  unsigned long __cil_tmp37 ;
  unsigned long __cil_tmp38 ;
  unsigned long __cil_tmp39 ;
  unsigned long __cil_tmp40 ;
  VALUE_PAIR *__cil_tmp41 ;
  void *__cil_tmp42 ;
  unsigned long __cil_tmp43 ;
  unsigned long __cil_tmp44 ;
  unsigned long __cil_tmp45 ;
  unsigned long __cil_tmp46 ;
  VALUE_PAIR *__cil_tmp47 ;
  unsigned long __cil_tmp48 ;
  unsigned long __cil_tmp49 ;
  void *__cil_tmp50 ;
  unsigned long __cil_tmp51 ;
  unsigned long __cil_tmp52 ;
  void *__cil_tmp53 ;
  unsigned long __cil_tmp54 ;
  unsigned long __cil_tmp55 ;
  unsigned long __cil_tmp56 ;
  unsigned long __cil_tmp57 ;
  unsigned long __cil_tmp58 ;
  unsigned long __cil_tmp59 ;
  uint8_t *__cil_tmp60 ;
  char *__cil_tmp61 ;
  char const   *__cil_tmp62 ;
  unsigned long __cil_tmp63 ;
  unsigned long __cil_tmp64 ;
  unsigned long __cil_tmp65 ;
  unsigned long __cil_tmp66 ;
  uint8_t *__cil_tmp67 ;
  char *__cil_tmp68 ;
  char const   *__cil_tmp69 ;
  unsigned long __cil_tmp70 ;
  unsigned long __cil_tmp71 ;
  void *__cil_tmp72 ;
  unsigned long __cil_tmp73 ;
  unsigned long __cil_tmp74 ;
  void *__cil_tmp75 ;
  unsigned long __cil_tmp76 ;
  unsigned long __cil_tmp77 ;
  unsigned long __cil_tmp78 ;
  unsigned long __cil_tmp79 ;
  int __cil_tmp80 ;
  unsigned long __cil_tmp81 ;
  unsigned long __cil_tmp82 ;
  unsigned long __cil_tmp83 ;
  unsigned long __cil_tmp84 ;
  uint8_t *__cil_tmp85 ;
  char *__cil_tmp86 ;
  char const   *__cil_tmp87 ;
  unsigned long __cil_tmp88 ;
  unsigned long __cil_tmp89 ;
  unsigned long __cil_tmp90 ;
  unsigned long __cil_tmp91 ;
  uint8_t *__cil_tmp92 ;
  char *__cil_tmp93 ;
  char const   *__cil_tmp94 ;
  unsigned long __cil_tmp95 ;
  unsigned long __cil_tmp96 ;
  int __cil_tmp97 ;
  unsigned long __cil_tmp98 ;
  unsigned long __cil_tmp99 ;
  RADIUS_PACKET *__cil_tmp100 ;
  unsigned long __cil_tmp101 ;
  unsigned long __cil_tmp102 ;
  char *__cil_tmp103 ;
  unsigned long __cil_tmp104 ;
  unsigned long __cil_tmp105 ;
  unsigned long __cil_tmp106 ;
  unsigned long __cil_tmp107 ;
  uint8_t __cil_tmp108 ;
  int __cil_tmp109 ;
  unsigned long __cil_tmp110 ;
  unsigned long __cil_tmp111 ;
  char *__cil_tmp112 ;
  char *__cil_tmp113 ;
  void const   *__cil_tmp114 ;
  unsigned long __cil_tmp115 ;
  unsigned long __cil_tmp116 ;
  unsigned long __cil_tmp117 ;
  unsigned long __cil_tmp118 ;
  uint8_t *__cil_tmp119 ;
  uint8_t *__cil_tmp120 ;
  void const   *__cil_tmp121 ;
  unsigned long __cil_tmp122 ;
  unsigned long __cil_tmp123 ;
  unsigned long __cil_tmp124 ;
  unsigned long __cil_tmp125 ;
  char *__cil_tmp126 ;
  VALUE_PAIR **mem_127 ;
  uint32_t *mem_128 ;
  struct value_pair **mem_129 ;
  VALUE_PAIR **mem_130 ;
  RADIUS_PACKET **mem_131 ;
  VALUE_PAIR **mem_132 ;
  VALUE_PAIR **mem_133 ;
  VALUE_PAIR **mem_134 ;
  VALUE_PAIR **mem_135 ;
  int *mem_136 ;
  int *mem_137 ;
  RADIUS_PACKET **mem_138 ;
  uint8_t *mem_139 ;

  {
#line 160
  auth_type = -1;
#line 162
  auth_type_count = 0;
#line 163
  result = 0;
#line 170
  __cil_tmp14 = (unsigned long )request;
#line 170
  __cil_tmp15 = __cil_tmp14 + 40;
#line 170
  mem_127 = (VALUE_PAIR **)__cil_tmp15;
#line 170
  cur_config_item = *mem_127;
  {
#line 171
  while (1) {
    while_0_continue: /* CIL Label */ ;
    {
#line 171
    auth_type_pair = pairfind(cur_config_item, 1000);
    }
    {
#line 171
    __cil_tmp16 = (void *)0;
#line 171
    __cil_tmp17 = (unsigned long )__cil_tmp16;
#line 171
    __cil_tmp18 = (unsigned long )auth_type_pair;
#line 171
    if (__cil_tmp18 != __cil_tmp17) {

    } else {
      goto while_0_break;
    }
    }
#line 172
    __cil_tmp19 = (unsigned long )auth_type_pair;
#line 172
    __cil_tmp20 = __cil_tmp19 + 52;
#line 172
    mem_128 = (uint32_t *)__cil_tmp20;
#line 172
    __cil_tmp21 = *mem_128;
#line 172
    auth_type = (int )__cil_tmp21;
#line 173
    auth_type_count = auth_type_count + 1;
#line 175
    if (debug_flag > 1) {
      {
#line 175
      __cil_tmp22 = 0 * 1UL;
#line 175
      __cil_tmp23 = 88 + __cil_tmp22;
#line 175
      __cil_tmp24 = (unsigned long )auth_type_pair;
#line 175
      __cil_tmp25 = __cil_tmp24 + __cil_tmp23;
#line 175
      __cil_tmp26 = (uint8_t *)__cil_tmp25;
#line 175
      log_debug("  rad_check_password:  Found Auth-Type %s", __cil_tmp26);
      }
    } else {

    }
#line 177
    __cil_tmp27 = (unsigned long )auth_type_pair;
#line 177
    __cil_tmp28 = __cil_tmp27 + 352;
#line 177
    mem_129 = (struct value_pair **)__cil_tmp28;
#line 177
    cur_config_item = *mem_129;
#line 179
    if (auth_type == 4) {
#line 180
      if (debug_flag > 1) {
        {
#line 180
        log_debug("  rad_check_password: Auth-Type = Reject, rejecting user");
        }
      } else {

      }
#line 181
      return (-2);
    } else {

    }
  }
  while_0_break: /* CIL Label */ ;
  }
#line 185
  if (auth_type_count > 1) {
#line 185
    if (debug_flag) {
      {
#line 186
      __cil_tmp29 = 0 * 1UL;
#line 186
      __cil_tmp30 = 88 + __cil_tmp29;
#line 186
      __cil_tmp31 = (unsigned long )request;
#line 186
      __cil_tmp32 = __cil_tmp31 + 48;
#line 186
      mem_130 = (VALUE_PAIR **)__cil_tmp32;
#line 186
      __cil_tmp33 = *mem_130;
#line 186
      __cil_tmp34 = (unsigned long )__cil_tmp33;
#line 186
      __cil_tmp35 = __cil_tmp34 + __cil_tmp30;
#line 186
      __cil_tmp36 = (uint8_t *)__cil_tmp35;
#line 186
      radlog(4, "Warning:  Found %d auth-types on request for user \'%s\'", auth_type_count,
             __cil_tmp36);
      }
    } else {

    }
  } else {

  }
#line 196
  if (auth_type == 254) {
    goto _L;
  } else {
    {
#line 196
    __cil_tmp37 = (unsigned long )request;
#line 196
    __cil_tmp38 = __cil_tmp37 + 16;
    {
#line 196
    mem_131 = (RADIUS_PACKET **)__cil_tmp38;
#line 196
    if (*mem_131) {
      _L: /* CIL Label */ 
#line 197
      if (debug_flag > 1) {
        {
#line 197
        log_debug("  rad_check_password: Auth-Type = Accept, accepting the user");
        }
      } else {

      }
#line 198
      return (0);
    } else {

    }
    }
    }
  }
  {
#line 204
  __cil_tmp39 = (unsigned long )request;
#line 204
  __cil_tmp40 = __cil_tmp39 + 40;
#line 204
  mem_132 = (VALUE_PAIR **)__cil_tmp40;
#line 204
  __cil_tmp41 = *mem_132;
#line 204
  password_pair = pairfind(__cil_tmp41, 1006);
  }
  {
#line 204
  __cil_tmp42 = (void *)0;
#line 204
  __cil_tmp43 = (unsigned long )__cil_tmp42;
#line 204
  __cil_tmp44 = (unsigned long )password_pair;
#line 204
  if (__cil_tmp44 != __cil_tmp43) {
#line 209
    if (auth_type == -1) {
#line 209
      auth_type = 3;
    } else {

    }
  } else {
    {
#line 211
    __cil_tmp45 = (unsigned long )request;
#line 211
    __cil_tmp46 = __cil_tmp45 + 40;
#line 211
    mem_133 = (VALUE_PAIR **)__cil_tmp46;
#line 211
    __cil_tmp47 = *mem_133;
#line 211
    password_pair = pairfind(__cil_tmp47, 2);
    }
  }
  }
#line 214
  if (auth_type < 0) {
#line 215
    if (password_pair) {
#line 216
      auth_type = 0;
    } else {
#line 224
      if (debug_flag > 1) {
        {
#line 224
        log_debug("auth: No authenticate method (Auth-Type) configuration found for the request: Rejecting the user");
        }
      } else {

      }
#line 225
      return (-2);
    }
  } else {

  }
#line 230
  if (auth_type == 3) {
    goto switch_1_3;
  } else {
#line 259
    if (auth_type == 0) {
      goto switch_1_0;
    } else {
      {
      goto switch_1_default;
#line 229
      if (0) {
        switch_1_3: /* CIL Label */ 
#line 236
        __cil_tmp48 = (unsigned long )request;
#line 236
        __cil_tmp49 = __cil_tmp48 + 56;
#line 236
        mem_134 = (VALUE_PAIR **)__cil_tmp49;
#line 236
        auth_item = *mem_134;
        {
#line 237
        __cil_tmp50 = (void *)0;
#line 237
        __cil_tmp51 = (unsigned long )__cil_tmp50;
#line 237
        __cil_tmp52 = (unsigned long )auth_item;
#line 237
        if (__cil_tmp52 == __cil_tmp51) {
#line 238
          if (debug_flag > 1) {
            {
#line 238
            log_debug("auth: No User-Password or CHAP-Password attribute in the request");
            }
          } else {

          }
#line 239
          return (-1);
        } else {

        }
        }
#line 242
        if (debug_flag > 1) {
          {
#line 242
          log_debug("auth: type Crypt");
          }
        } else {

        }
        {
#line 243
        __cil_tmp53 = (void *)0;
#line 243
        __cil_tmp54 = (unsigned long )__cil_tmp53;
#line 243
        __cil_tmp55 = (unsigned long )password_pair;
#line 243
        if (__cil_tmp55 == __cil_tmp54) {
#line 244
          if (debug_flag > 1) {
            {
#line 244
            log_debug("No Crypt-Password configured for the user");
            }
          } else {

          }
          {
#line 245
          rad_authlog("Login incorrect (No Crypt-Password configured for the user)",
                      request, 0);
          }
#line 247
          return (-1);
        } else {

        }
        }
        {
#line 250
        __cil_tmp56 = 0 * 1UL;
#line 250
        __cil_tmp57 = 88 + __cil_tmp56;
#line 250
        __cil_tmp58 = (unsigned long )auth_item;
#line 250
        __cil_tmp59 = __cil_tmp58 + __cil_tmp57;
#line 250
        __cil_tmp60 = (uint8_t *)__cil_tmp59;
#line 250
        __cil_tmp61 = (char *)__cil_tmp60;
#line 250
        __cil_tmp62 = (char const   *)__cil_tmp61;
#line 250
        __cil_tmp63 = 0 * 1UL;
#line 250
        __cil_tmp64 = 88 + __cil_tmp63;
#line 250
        __cil_tmp65 = (unsigned long )password_pair;
#line 250
        __cil_tmp66 = __cil_tmp65 + __cil_tmp64;
#line 250
        __cil_tmp67 = (uint8_t *)__cil_tmp66;
#line 250
        __cil_tmp68 = (char *)__cil_tmp67;
#line 250
        __cil_tmp69 = (char const   *)__cil_tmp68;
#line 250
        tmp = lrad_crypt_check(__cil_tmp62, __cil_tmp69);
        }
#line 252
        if (tmp == -1) {
          goto switch_2_neg_1;
        } else {
#line 255
          if (tmp == 1) {
            goto switch_2_1;
          } else {
#line 250
            if (0) {
              switch_2_neg_1: /* CIL Label */ 
              {
#line 253
              rad_authlog("Login incorrect (system failed to supply an encrypted password for comparison)",
                          request, 0);
              }
              switch_2_1: /* CIL Label */ 
#line 256
              return (-1);
            } else {
              switch_2_break: /* CIL Label */ ;
            }
          }
        }
        goto switch_1_break;
        switch_1_0: /* CIL Label */ 
#line 260
        if (debug_flag > 1) {
          {
#line 260
          log_debug("auth: type Local");
          }
        } else {

        }
#line 267
        __cil_tmp70 = (unsigned long )request;
#line 267
        __cil_tmp71 = __cil_tmp70 + 56;
#line 267
        mem_135 = (VALUE_PAIR **)__cil_tmp71;
#line 267
        auth_item = *mem_135;
        {
#line 268
        __cil_tmp72 = (void *)0;
#line 268
        __cil_tmp73 = (unsigned long )__cil_tmp72;
#line 268
        __cil_tmp74 = (unsigned long )auth_item;
#line 268
        if (__cil_tmp74 == __cil_tmp73) {
#line 269
          if (debug_flag > 1) {
            {
#line 269
            log_debug("auth: No User-Password or CHAP-Password attribute in the request");
            }
          } else {

          }
#line 270
          return (-1);
        } else {

        }
        }
        {
#line 276
        __cil_tmp75 = (void *)0;
#line 276
        __cil_tmp76 = (unsigned long )__cil_tmp75;
#line 276
        __cil_tmp77 = (unsigned long )password_pair;
#line 276
        if (__cil_tmp77 == __cil_tmp76) {
#line 277
          if (debug_flag > 1) {
            {
#line 277
            log_debug("auth: No password configured for the user");
            }
          } else {

          }
          {
#line 278
          rad_authlog("Login incorrect (No password configured for the user)", request,
                      0);
          }
#line 280
          return (-1);
        } else {

        }
        }
        {
#line 286
        __cil_tmp78 = (unsigned long )auth_item;
#line 286
        __cil_tmp79 = __cil_tmp78 + 40;
#line 286
        mem_136 = (int *)__cil_tmp79;
#line 286
        __cil_tmp80 = *mem_136;
#line 286
        if (__cil_tmp80 == 2) {
          {
#line 287
          __cil_tmp81 = 0 * 1UL;
#line 287
          __cil_tmp82 = 88 + __cil_tmp81;
#line 287
          __cil_tmp83 = (unsigned long )password_pair;
#line 287
          __cil_tmp84 = __cil_tmp83 + __cil_tmp82;
#line 287
          __cil_tmp85 = (uint8_t *)__cil_tmp84;
#line 287
          __cil_tmp86 = (char *)__cil_tmp85;
#line 287
          __cil_tmp87 = (char const   *)__cil_tmp86;
#line 287
          __cil_tmp88 = 0 * 1UL;
#line 287
          __cil_tmp89 = 88 + __cil_tmp88;
#line 287
          __cil_tmp90 = (unsigned long )auth_item;
#line 287
          __cil_tmp91 = __cil_tmp90 + __cil_tmp89;
#line 287
          __cil_tmp92 = (uint8_t *)__cil_tmp91;
#line 287
          __cil_tmp93 = (char *)__cil_tmp92;
#line 287
          __cil_tmp94 = (char const   *)__cil_tmp93;
#line 287
          tmp___0 = strcmp(__cil_tmp87, __cil_tmp94);
          }
#line 287
          if (tmp___0 != 0) {
#line 289
            if (debug_flag > 1) {
              {
#line 289
              log_debug("auth: user supplied User-Password does NOT match local User-Password");
              }
            } else {

            }
#line 290
            return (-1);
          } else {

          }
#line 292
          if (debug_flag > 1) {
            {
#line 292
            log_debug("auth: user supplied User-Password matches local User-Password");
            }
          } else {

          }
          goto switch_1_break;
        } else {
          {
#line 295
          __cil_tmp95 = (unsigned long )auth_item;
#line 295
          __cil_tmp96 = __cil_tmp95 + 40;
#line 295
          mem_137 = (int *)__cil_tmp96;
#line 295
          __cil_tmp97 = *mem_137;
#line 295
          if (__cil_tmp97 != 3) {
#line 296
            if (debug_flag > 1) {
              {
#line 296
              log_debug("The user did not supply a User-Password or a CHAP-Password attribute");
              }
            } else {

            }
            {
#line 297
            rad_authlog("Login incorrect (no User-Password or CHAP-Password attribute)",
                        request, 0);
            }
#line 299
            return (-1);
          } else {

          }
          }
        }
        }
        {
#line 302
        __cil_tmp98 = (unsigned long )request;
#line 302
        __cil_tmp99 = __cil_tmp98 + 8;
#line 302
        mem_138 = (RADIUS_PACKET **)__cil_tmp99;
#line 302
        __cil_tmp100 = *mem_138;
#line 302
        __cil_tmp101 = 0 * 1UL;
#line 302
        __cil_tmp102 = (unsigned long )(string) + __cil_tmp101;
#line 302
        __cil_tmp103 = (char *)__cil_tmp102;
#line 302
        __cil_tmp104 = 0 * 1UL;
#line 302
        __cil_tmp105 = 88 + __cil_tmp104;
#line 302
        __cil_tmp106 = (unsigned long )auth_item;
#line 302
        __cil_tmp107 = __cil_tmp106 + __cil_tmp105;
#line 302
        mem_139 = (uint8_t *)__cil_tmp107;
#line 302
        __cil_tmp108 = *mem_139;
#line 302
        __cil_tmp109 = (int )__cil_tmp108;
#line 302
        rad_chap_encode(__cil_tmp100, __cil_tmp103, __cil_tmp109, password_pair);
#line 308
        __cil_tmp110 = 0 * 1UL;
#line 308
        __cil_tmp111 = (unsigned long )(string) + __cil_tmp110;
#line 308
        __cil_tmp112 = (char *)__cil_tmp111;
#line 308
        __cil_tmp113 = __cil_tmp112 + 1;
#line 308
        __cil_tmp114 = (void const   *)__cil_tmp113;
#line 308
        __cil_tmp115 = 0 * 1UL;
#line 308
        __cil_tmp116 = 88 + __cil_tmp115;
#line 308
        __cil_tmp117 = (unsigned long )auth_item;
#line 308
        __cil_tmp118 = __cil_tmp117 + __cil_tmp116;
#line 308
        __cil_tmp119 = (uint8_t *)__cil_tmp118;
#line 308
        __cil_tmp120 = __cil_tmp119 + 1;
#line 308
        __cil_tmp121 = (void const   *)__cil_tmp120;
#line 308
        tmp___1 = memcmp(__cil_tmp114, __cil_tmp121, 16UL);
        }
#line 308
        if (tmp___1 != 0) {
#line 310
          if (debug_flag > 1) {
            {
#line 310
            log_debug("auth: user supplied CHAP-Password does NOT match local User-Password");
            }
          } else {

          }
#line 311
          return (-1);
        } else {

        }
#line 313
        if (debug_flag > 1) {
          {
#line 313
          log_debug("auth: user supplied CHAP-Password matches local User-Password");
          }
        } else {

        }
        goto switch_1_break;
        switch_1_default: /* CIL Label */ ;
#line 316
        if (debug_flag > 1) {
          {
#line 316
          tmp___2 = dict_valbyattr(1000, auth_type);
#line 316
          __cil_tmp122 = 0 * 1UL;
#line 316
          __cil_tmp123 = 8 + __cil_tmp122;
#line 316
          __cil_tmp124 = (unsigned long )tmp___2;
#line 316
          __cil_tmp125 = __cil_tmp124 + __cil_tmp123;
#line 316
          __cil_tmp126 = (char *)__cil_tmp125;
#line 316
          log_debug("auth: type \"%s\"", __cil_tmp126);
          }
        } else {

        }
        {
#line 324
        result = module_authenticate(auth_type, request);
        }
#line 332
        if (result == 1) {
          goto switch_3_1;
        } else {
#line 333
          if (result == 0) {
            goto switch_3_1;
          } else {
#line 334
            if (result == 5) {
              goto switch_3_1;
            } else {
#line 335
              if (result == 4) {
                goto switch_3_1;
              } else {
#line 336
                if (result == 6) {
                  goto switch_3_1;
                } else {
#line 337
                  if (result == 7) {
                    goto switch_3_1;
                  } else {
#line 338
                    if (result == 8) {
                      goto switch_3_1;
                    } else {
#line 341
                      if (result == 2) {
                        goto switch_3_2;
                      } else {
#line 344
                        if (result == 3) {
                          goto switch_3_3;
                        } else {
#line 325
                          if (0) {
                            switch_3_1: /* CIL Label */ 
                            switch_3_0: /* CIL Label */ 
                            switch_3_5: /* CIL Label */ 
                            switch_3_4: /* CIL Label */ 
                            switch_3_6: /* CIL Label */ 
                            switch_3_7: /* CIL Label */ 
                            switch_3_8: /* CIL Label */ 
#line 339
                            result = -1;
                            goto switch_3_break;
                            switch_3_2: /* CIL Label */ 
#line 342
                            result = 0;
                            goto switch_3_break;
                            switch_3_3: /* CIL Label */ 
#line 345
                            result = 1;
                            goto switch_3_break;
                          } else {
                            switch_3_break: /* CIL Label */ ;
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
        goto switch_1_break;
      } else {
        switch_1_break: /* CIL Label */ ;
      }
      }
    }
  }
#line 351
  return (result);
}
}
#line 359 "auth.c"
int rad_postauth(REQUEST *request ) 
{ int result ;
  int postauth_type ;
  VALUE_PAIR *postauth_type_item ;
  void *__cil_tmp5 ;
  unsigned long __cil_tmp6 ;
  unsigned long __cil_tmp7 ;
  VALUE_PAIR *__cil_tmp8 ;
  unsigned long __cil_tmp9 ;
  unsigned long __cil_tmp10 ;
  uint32_t __cil_tmp11 ;
  unsigned long __cil_tmp12 ;
  unsigned long __cil_tmp13 ;
  RADIUS_PACKET *__cil_tmp14 ;
  unsigned long __cil_tmp15 ;
  unsigned long __cil_tmp16 ;
  VALUE_PAIR **mem_17 ;
  uint32_t *mem_18 ;
  RADIUS_PACKET **mem_19 ;
  unsigned int *mem_20 ;

  {
  {
#line 362
  postauth_type = 0;
#line 363
  __cil_tmp5 = (void *)0;
#line 363
  postauth_type_item = (VALUE_PAIR *)__cil_tmp5;
#line 368
  __cil_tmp6 = (unsigned long )request;
#line 368
  __cil_tmp7 = __cil_tmp6 + 40;
#line 368
  mem_17 = (VALUE_PAIR **)__cil_tmp7;
#line 368
  __cil_tmp8 = *mem_17;
#line 368
  postauth_type_item = pairfind(__cil_tmp8, 1014);
  }
#line 369
  if (postauth_type_item) {
#line 370
    __cil_tmp9 = (unsigned long )postauth_type_item;
#line 370
    __cil_tmp10 = __cil_tmp9 + 52;
#line 370
    mem_18 = (uint32_t *)__cil_tmp10;
#line 370
    __cil_tmp11 = *mem_18;
#line 370
    postauth_type = (int )__cil_tmp11;
  } else {

  }
  {
#line 371
  result = module_post_auth(postauth_type, request);
  }
#line 379
  if (result == 1) {
    goto switch_4_1;
  } else {
#line 380
    if (result == 0) {
      goto switch_4_1;
    } else {
#line 381
      if (result == 5) {
        goto switch_4_1;
      } else {
#line 382
        if (result == 4) {
          goto switch_4_1;
        } else {
#line 390
          if (result == 6) {
            goto switch_4_6;
          } else {
#line 391
            if (result == 7) {
              goto switch_4_6;
            } else {
#line 392
              if (result == 8) {
                goto switch_4_6;
              } else {
#line 393
                if (result == 2) {
                  goto switch_4_6;
                } else {
#line 394
                  if (result == 3) {
                    goto switch_4_6;
                  } else {
                    {
                    goto switch_4_default;
#line 372
                    if (0) {
                      switch_4_default: /* CIL Label */ ;
                      goto switch_4_break;
                      switch_4_1: /* CIL Label */ 
                      switch_4_0: /* CIL Label */ 
                      switch_4_5: /* CIL Label */ 
                      switch_4_4: /* CIL Label */ 
#line 383
                      __cil_tmp12 = (unsigned long )request;
#line 383
                      __cil_tmp13 = __cil_tmp12 + 24;
#line 383
                      mem_19 = (RADIUS_PACKET **)__cil_tmp13;
#line 383
                      __cil_tmp14 = *mem_19;
#line 383
                      __cil_tmp15 = (unsigned long )__cil_tmp14;
#line 383
                      __cil_tmp16 = __cil_tmp15 + 52;
#line 383
                      mem_20 = (unsigned int *)__cil_tmp16;
#line 383
                      *mem_20 = 3U;
#line 384
                      result = 0;
                      goto switch_4_break;
                      switch_4_6: /* CIL Label */ 
                      switch_4_7: /* CIL Label */ 
                      switch_4_8: /* CIL Label */ 
                      switch_4_2: /* CIL Label */ 
                      switch_4_3: /* CIL Label */ 
#line 395
                      result = 2;
                      goto switch_4_break;
                    } else {
                      switch_4_break: /* CIL Label */ ;
                    }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
#line 398
  return (result);
}
}
#line 405 "auth.c"
static int rad_postauth_reject(REQUEST *request ) 
{ int result ;
  VALUE_PAIR *tmp ;
  DICT_VALUE *dval ;
  unsigned long __cil_tmp5 ;
  unsigned long __cil_tmp6 ;
  VALUE_PAIR **__cil_tmp7 ;
  unsigned long __cil_tmp8 ;
  unsigned long __cil_tmp9 ;
  unsigned long __cil_tmp10 ;
  unsigned long __cil_tmp11 ;
  int __cil_tmp12 ;
  unsigned long __cil_tmp13 ;
  unsigned long __cil_tmp14 ;
  VALUE_PAIR **__cil_tmp15 ;
  int *mem_16 ;
  uint32_t *mem_17 ;

  {
  {
#line 411
  dval = dict_valbyname(1014, "REJECT");
  }
#line 412
  if (dval) {
    {
#line 414
    __cil_tmp5 = (unsigned long )request;
#line 414
    __cil_tmp6 = __cil_tmp5 + 40;
#line 414
    __cil_tmp7 = (VALUE_PAIR **)__cil_tmp6;
#line 414
    pairdelete(__cil_tmp7, 1014);
#line 415
    tmp = paircreate(1014, 1);
#line 416
    __cil_tmp8 = (unsigned long )tmp;
#line 416
    __cil_tmp9 = __cil_tmp8 + 52;
#line 416
    __cil_tmp10 = (unsigned long )dval;
#line 416
    __cil_tmp11 = __cil_tmp10 + 4;
#line 416
    mem_16 = (int *)__cil_tmp11;
#line 416
    __cil_tmp12 = *mem_16;
#line 416
    mem_17 = (uint32_t *)__cil_tmp9;
#line 416
    *mem_17 = (unsigned int )__cil_tmp12;
#line 417
    __cil_tmp13 = (unsigned long )request;
#line 417
    __cil_tmp14 = __cil_tmp13 + 40;
#line 417
    __cil_tmp15 = (VALUE_PAIR **)__cil_tmp14;
#line 417
    pairadd(__cil_tmp15, tmp);
#line 418
    result = rad_postauth(request);
    }
  } else {
#line 421
    result = 2;
  }
#line 423
  return (result);
}
}
#line 432 "auth.c"
int rad_authenticate(REQUEST *request ) 
{ VALUE_PAIR *namepair ;
  VALUE_PAIR *check_item ;
  VALUE_PAIR *auth_item ;
  VALUE_PAIR *module_msg ;
  VALUE_PAIR *tmp ;
  int result ;
  int r ;
  char umsg[255] ;
  char const   *user_msg ;
  char const   *password ;
  char logstr[1024] ;
  char autz_retry ;
  int autz_type ;
  char msg[270] ;
  VALUE_PAIR *autz_type_item ;
  REALM *realm ;
  uint32_t tmp___0 ;
  char msg___0[273] ;
  u_char *p ;
  unsigned short const   **tmp___1 ;
  VALUE_PAIR *session_type ;
  int sess_type ;
  char mpp_ok ;
  VALUE_PAIR *port_limit ;
  char const   *tmp___2 ;
  VALUE_PAIR *vpPortId ;
  unsigned long tvalue ;
  uint32_t tmp___3 ;
  char msg___1[266] ;
  void *__cil_tmp31 ;
  void *__cil_tmp32 ;
  unsigned long __cil_tmp33 ;
  unsigned long __cil_tmp34 ;
  unsigned long __cil_tmp35 ;
  unsigned long __cil_tmp36 ;
  RADIUS_PACKET *__cil_tmp37 ;
  unsigned long __cil_tmp38 ;
  unsigned long __cil_tmp39 ;
  unsigned int __cil_tmp40 ;
  void *__cil_tmp41 ;
  unsigned long __cil_tmp42 ;
  unsigned long __cil_tmp43 ;
  unsigned long __cil_tmp44 ;
  unsigned long __cil_tmp45 ;
  RADIUS_PACKET *__cil_tmp46 ;
  unsigned long __cil_tmp47 ;
  unsigned long __cil_tmp48 ;
  unsigned int __cil_tmp49 ;
  unsigned long __cil_tmp50 ;
  unsigned long __cil_tmp51 ;
  RADIUS_PACKET *__cil_tmp52 ;
  unsigned long __cil_tmp53 ;
  unsigned long __cil_tmp54 ;
  unsigned long __cil_tmp55 ;
  unsigned long __cil_tmp56 ;
  RADIUS_PACKET *__cil_tmp57 ;
  unsigned long __cil_tmp58 ;
  unsigned long __cil_tmp59 ;
  unsigned int __cil_tmp60 ;
  unsigned long __cil_tmp61 ;
  unsigned long __cil_tmp62 ;
  unsigned long __cil_tmp63 ;
  unsigned long __cil_tmp64 ;
  unsigned long __cil_tmp65 ;
  unsigned long __cil_tmp66 ;
  VALUE_PAIR **__cil_tmp67 ;
  unsigned long __cil_tmp68 ;
  unsigned long __cil_tmp69 ;
  RADIUS_PACKET *__cil_tmp70 ;
  unsigned long __cil_tmp71 ;
  unsigned long __cil_tmp72 ;
  unsigned int __cil_tmp73 ;
  unsigned long __cil_tmp74 ;
  unsigned long __cil_tmp75 ;
  RADIUS_PACKET *__cil_tmp76 ;
  unsigned long __cil_tmp77 ;
  unsigned long __cil_tmp78 ;
  unsigned int __cil_tmp79 ;
  unsigned long __cil_tmp80 ;
  unsigned long __cil_tmp81 ;
  RADIUS_PACKET *__cil_tmp82 ;
  unsigned long __cil_tmp83 ;
  unsigned long __cil_tmp84 ;
  unsigned long __cil_tmp85 ;
  unsigned long __cil_tmp86 ;
  unsigned long __cil_tmp87 ;
  unsigned long __cil_tmp88 ;
  VALUE_PAIR *__cil_tmp89 ;
  unsigned long __cil_tmp90 ;
  unsigned long __cil_tmp91 ;
  unsigned long __cil_tmp92 ;
  unsigned long __cil_tmp93 ;
  RADIUS_PACKET *__cil_tmp94 ;
  unsigned long __cil_tmp95 ;
  unsigned long __cil_tmp96 ;
  VALUE_PAIR *__cil_tmp97 ;
  unsigned long __cil_tmp98 ;
  unsigned long __cil_tmp99 ;
  unsigned long __cil_tmp100 ;
  unsigned long __cil_tmp101 ;
  unsigned long __cil_tmp102 ;
  unsigned long __cil_tmp103 ;
  uint8_t *__cil_tmp104 ;
  unsigned long __cil_tmp105 ;
  unsigned long __cil_tmp106 ;
  RADIUS_PACKET *__cil_tmp107 ;
  unsigned long __cil_tmp108 ;
  unsigned long __cil_tmp109 ;
  VALUE_PAIR *__cil_tmp110 ;
  void *__cil_tmp111 ;
  unsigned long __cil_tmp112 ;
  unsigned long __cil_tmp113 ;
  unsigned long __cil_tmp114 ;
  unsigned long __cil_tmp115 ;
  unsigned long __cil_tmp116 ;
  unsigned long __cil_tmp117 ;
  RADIUS_PACKET *__cil_tmp118 ;
  unsigned long __cil_tmp119 ;
  unsigned long __cil_tmp120 ;
  VALUE_PAIR *__cil_tmp121 ;
  void *__cil_tmp122 ;
  unsigned long __cil_tmp123 ;
  unsigned long __cil_tmp124 ;
  unsigned long __cil_tmp125 ;
  unsigned long __cil_tmp126 ;
  char *__cil_tmp127 ;
  char * __restrict  __cil_tmp128 ;
  char const   * __restrict  __cil_tmp129 ;
  unsigned long __cil_tmp130 ;
  unsigned long __cil_tmp131 ;
  unsigned long __cil_tmp132 ;
  unsigned long __cil_tmp133 ;
  uint8_t *__cil_tmp134 ;
  unsigned long __cil_tmp135 ;
  unsigned long __cil_tmp136 ;
  char *__cil_tmp137 ;
  char const   *__cil_tmp138 ;
  unsigned long __cil_tmp139 ;
  unsigned long __cil_tmp140 ;
  RADIUS_PACKET *__cil_tmp141 ;
  unsigned long __cil_tmp142 ;
  unsigned long __cil_tmp143 ;
  void *__cil_tmp144 ;
  unsigned long __cil_tmp145 ;
  unsigned long __cil_tmp146 ;
  VALUE_PAIR *__cil_tmp147 ;
  unsigned long __cil_tmp148 ;
  unsigned long __cil_tmp149 ;
  uint32_t __cil_tmp150 ;
  void *__cil_tmp151 ;
  unsigned long __cil_tmp152 ;
  unsigned long __cil_tmp153 ;
  unsigned long __cil_tmp154 ;
  RADIUS_PACKET *__cil_tmp155 ;
  unsigned long __cil_tmp156 ;
  unsigned long __cil_tmp157 ;
  unsigned long __cil_tmp158 ;
  VALUE_PAIR *__cil_tmp159 ;
  void *__cil_tmp160 ;
  unsigned long __cil_tmp161 ;
  unsigned long __cil_tmp162 ;
  unsigned long __cil_tmp163 ;
  unsigned long __cil_tmp164 ;
  unsigned long __cil_tmp165 ;
  unsigned long __cil_tmp166 ;
  uint8_t *__cil_tmp167 ;
  char const   *__cil_tmp168 ;
  void *__cil_tmp169 ;
  unsigned long __cil_tmp170 ;
  unsigned long __cil_tmp171 ;
  unsigned long __cil_tmp172 ;
  unsigned long __cil_tmp173 ;
  int __cil_tmp174 ;
  unsigned long __cil_tmp175 ;
  unsigned long __cil_tmp176 ;
  unsigned long __cil_tmp177 ;
  in_addr_t __cil_tmp178 ;
  unsigned long __cil_tmp179 ;
  unsigned long __cil_tmp180 ;
  unsigned long __cil_tmp181 ;
  unsigned long __cil_tmp182 ;
  char *__cil_tmp183 ;
  unsigned long __cil_tmp184 ;
  unsigned long __cil_tmp185 ;
  unsigned long __cil_tmp186 ;
  unsigned long __cil_tmp187 ;
  RADIUS_PACKET *__cil_tmp188 ;
  unsigned long __cil_tmp189 ;
  unsigned long __cil_tmp190 ;
  unsigned long __cil_tmp191 ;
  unsigned long __cil_tmp192 ;
  RADIUS_PACKET *__cil_tmp193 ;
  unsigned long __cil_tmp194 ;
  unsigned long __cil_tmp195 ;
  VALUE_PAIR *__cil_tmp196 ;
  void *__cil_tmp197 ;
  unsigned long __cil_tmp198 ;
  unsigned long __cil_tmp199 ;
  unsigned long __cil_tmp200 ;
  unsigned long __cil_tmp201 ;
  char *__cil_tmp202 ;
  char * __restrict  __cil_tmp203 ;
  char const   * __restrict  __cil_tmp204 ;
  unsigned long __cil_tmp205 ;
  unsigned long __cil_tmp206 ;
  unsigned long __cil_tmp207 ;
  unsigned long __cil_tmp208 ;
  uint8_t *__cil_tmp209 ;
  unsigned long __cil_tmp210 ;
  unsigned long __cil_tmp211 ;
  char *__cil_tmp212 ;
  char const   *__cil_tmp213 ;
  void *__cil_tmp214 ;
  unsigned long __cil_tmp215 ;
  unsigned long __cil_tmp216 ;
  unsigned long __cil_tmp217 ;
  unsigned long __cil_tmp218 ;
  int __cil_tmp219 ;
  unsigned long __cil_tmp220 ;
  unsigned long __cil_tmp221 ;
  unsigned long __cil_tmp222 ;
  unsigned long __cil_tmp223 ;
  u_char __cil_tmp224 ;
  int __cil_tmp225 ;
  u_char __cil_tmp226 ;
  int __cil_tmp227 ;
  unsigned short const   *__cil_tmp228 ;
  unsigned short const   *__cil_tmp229 ;
  unsigned short __cil_tmp230 ;
  int __cil_tmp231 ;
  unsigned long __cil_tmp232 ;
  unsigned long __cil_tmp233 ;
  VALUE_PAIR *__cil_tmp234 ;
  void *__cil_tmp235 ;
  unsigned long __cil_tmp236 ;
  unsigned long __cil_tmp237 ;
  unsigned long __cil_tmp238 ;
  unsigned long __cil_tmp239 ;
  VALUE_PAIR *__cil_tmp240 ;
  unsigned long __cil_tmp241 ;
  unsigned long __cil_tmp242 ;
  uint32_t __cil_tmp243 ;
  unsigned long __cil_tmp244 ;
  unsigned long __cil_tmp245 ;
  uint32_t __cil_tmp246 ;
  int __cil_tmp247 ;
  unsigned long __cil_tmp248 ;
  unsigned long __cil_tmp249 ;
  RADIUS_PACKET *__cil_tmp250 ;
  unsigned long __cil_tmp251 ;
  unsigned long __cil_tmp252 ;
  VALUE_PAIR *__cil_tmp253 ;
  void *__cil_tmp254 ;
  unsigned long __cil_tmp255 ;
  unsigned long __cil_tmp256 ;
  unsigned long __cil_tmp257 ;
  unsigned long __cil_tmp258 ;
  uint32_t __cil_tmp259 ;
  unsigned long __cil_tmp260 ;
  unsigned long __cil_tmp261 ;
  uint32_t __cil_tmp262 ;
  unsigned long __cil_tmp263 ;
  unsigned long __cil_tmp264 ;
  uint32_t __cil_tmp265 ;
  unsigned long __cil_tmp266 ;
  unsigned long __cil_tmp267 ;
  char *__cil_tmp268 ;
  char * __restrict  __cil_tmp269 ;
  char const   * __restrict  __cil_tmp270 ;
  unsigned long __cil_tmp271 ;
  unsigned long __cil_tmp272 ;
  uint32_t __cil_tmp273 ;
  int __cil_tmp274 ;
  unsigned long __cil_tmp275 ;
  unsigned long __cil_tmp276 ;
  char *__cil_tmp277 ;
  unsigned long __cil_tmp278 ;
  unsigned long __cil_tmp279 ;
  RADIUS_PACKET *__cil_tmp280 ;
  unsigned long __cil_tmp281 ;
  unsigned long __cil_tmp282 ;
  unsigned long __cil_tmp283 ;
  unsigned long __cil_tmp284 ;
  RADIUS_PACKET *__cil_tmp285 ;
  unsigned long __cil_tmp286 ;
  unsigned long __cil_tmp287 ;
  VALUE_PAIR **__cil_tmp288 ;
  unsigned long __cil_tmp289 ;
  unsigned long __cil_tmp290 ;
  RADIUS_PACKET *__cil_tmp291 ;
  unsigned long __cil_tmp292 ;
  unsigned long __cil_tmp293 ;
  unsigned long __cil_tmp294 ;
  unsigned long __cil_tmp295 ;
  char *__cil_tmp296 ;
  char * __restrict  __cil_tmp297 ;
  char const   * __restrict  __cil_tmp298 ;
  unsigned long __cil_tmp299 ;
  unsigned long __cil_tmp300 ;
  uint32_t __cil_tmp301 ;
  unsigned long __cil_tmp302 ;
  unsigned long __cil_tmp303 ;
  char *__cil_tmp304 ;
  char const   *__cil_tmp305 ;
  void *__cil_tmp306 ;
  unsigned long __cil_tmp307 ;
  unsigned long __cil_tmp308 ;
  unsigned long __cil_tmp309 ;
  unsigned long __cil_tmp310 ;
  int __cil_tmp311 ;
  unsigned long __cil_tmp312 ;
  unsigned long __cil_tmp313 ;
  RADIUS_PACKET *__cil_tmp314 ;
  unsigned long __cil_tmp315 ;
  unsigned long __cil_tmp316 ;
  VALUE_PAIR *__cil_tmp317 ;
  void *__cil_tmp318 ;
  unsigned long __cil_tmp319 ;
  unsigned long __cil_tmp320 ;
  unsigned long __cil_tmp321 ;
  unsigned long __cil_tmp322 ;
  unsigned int __cil_tmp323 ;
  unsigned long __cil_tmp324 ;
  unsigned long __cil_tmp325 ;
  RADIUS_PACKET *__cil_tmp326 ;
  unsigned long __cil_tmp327 ;
  unsigned long __cil_tmp328 ;
  VALUE_PAIR *__cil_tmp329 ;
  void *__cil_tmp330 ;
  unsigned long __cil_tmp331 ;
  unsigned long __cil_tmp332 ;
  unsigned long __cil_tmp333 ;
  unsigned long __cil_tmp334 ;
  uint32_t __cil_tmp335 ;
  unsigned long __cil_tmp336 ;
  unsigned long __cil_tmp337 ;
  unsigned long __cil_tmp338 ;
  unsigned long __cil_tmp339 ;
  uint32_t __cil_tmp340 ;
  unsigned long __cil_tmp341 ;
  unsigned long __cil_tmp342 ;
  unsigned int __cil_tmp343 ;
  unsigned long __cil_tmp344 ;
  unsigned long __cil_tmp345 ;
  unsigned long __cil_tmp346 ;
  unsigned long __cil_tmp347 ;
  unsigned long __cil_tmp348 ;
  unsigned long __cil_tmp349 ;
  uint8_t *__cil_tmp350 ;
  char *__cil_tmp351 ;
  unsigned long __cil_tmp352 ;
  unsigned long __cil_tmp353 ;
  uint32_t __cil_tmp354 ;
  unsigned long __cil_tmp355 ;
  unsigned long __cil_tmp356 ;
  RADIUS_PACKET *__cil_tmp357 ;
  unsigned long __cil_tmp358 ;
  unsigned long __cil_tmp359 ;
  VALUE_PAIR **__cil_tmp360 ;
  unsigned long __cil_tmp361 ;
  unsigned long __cil_tmp362 ;
  RADIUS_PACKET *__cil_tmp363 ;
  unsigned long __cil_tmp364 ;
  unsigned long __cil_tmp365 ;
  unsigned int __cil_tmp366 ;
  unsigned long __cil_tmp367 ;
  unsigned long __cil_tmp368 ;
  RADIUS_PACKET *__cil_tmp369 ;
  unsigned long __cil_tmp370 ;
  unsigned long __cil_tmp371 ;
  unsigned long __cil_tmp372 ;
  unsigned long __cil_tmp373 ;
  RADIUS_PACKET *__cil_tmp374 ;
  unsigned long __cil_tmp375 ;
  unsigned long __cil_tmp376 ;
  VALUE_PAIR *__cil_tmp377 ;
  void *__cil_tmp378 ;
  unsigned long __cil_tmp379 ;
  unsigned long __cil_tmp380 ;
  unsigned long __cil_tmp381 ;
  unsigned long __cil_tmp382 ;
  char *__cil_tmp383 ;
  char * __restrict  __cil_tmp384 ;
  char const   * __restrict  __cil_tmp385 ;
  unsigned long __cil_tmp386 ;
  unsigned long __cil_tmp387 ;
  unsigned long __cil_tmp388 ;
  unsigned long __cil_tmp389 ;
  uint8_t *__cil_tmp390 ;
  unsigned long __cil_tmp391 ;
  unsigned long __cil_tmp392 ;
  char *__cil_tmp393 ;
  char const   *__cil_tmp394 ;
  RADIUS_PACKET **mem_395 ;
  RADIUS_PACKET **mem_396 ;
  unsigned int *mem_397 ;
  RADIUS_PACKET **mem_398 ;
  unsigned int *mem_399 ;
  RADIUS_PACKET **mem_400 ;
  unsigned int *mem_401 ;
  RADIUS_PACKET **mem_402 ;
  unsigned int *mem_403 ;
  uint32_t *mem_404 ;
  uint32_t *mem_405 ;
  RADIUS_PACKET **mem_406 ;
  unsigned int *mem_407 ;
  RADIUS_PACKET **mem_408 ;
  unsigned int *mem_409 ;
  RADIUS_PACKET **mem_410 ;
  unsigned int *mem_411 ;
  VALUE_PAIR **mem_412 ;
  VALUE_PAIR **mem_413 ;
  RADIUS_PACKET **mem_414 ;
  VALUE_PAIR **mem_415 ;
  VALUE_PAIR **mem_416 ;
  VALUE_PAIR **mem_417 ;
  RADIUS_PACKET **mem_418 ;
  VALUE_PAIR **mem_419 ;
  VALUE_PAIR **mem_420 ;
  RADIUS_PACKET **mem_421 ;
  VALUE_PAIR **mem_422 ;
  RADIUS_PACKET **mem_423 ;
  unsigned int *mem_424 ;
  VALUE_PAIR **mem_425 ;
  uint32_t *mem_426 ;
  RADIUS_PACKET **mem_427 ;
  VALUE_PAIR **mem_428 ;
  int *mem_429 ;
  in_addr_t *mem_430 ;
  VALUE_PAIR **mem_431 ;
  RADIUS_PACKET **mem_432 ;
  unsigned int *mem_433 ;
  RADIUS_PACKET **mem_434 ;
  VALUE_PAIR **mem_435 ;
  int *mem_436 ;
  VALUE_PAIR **mem_437 ;
  VALUE_PAIR **mem_438 ;
  uint32_t *mem_439 ;
  uint32_t *mem_440 ;
  RADIUS_PACKET **mem_441 ;
  VALUE_PAIR **mem_442 ;
  uint32_t *mem_443 ;
  uint32_t *mem_444 ;
  uint32_t *mem_445 ;
  uint32_t *mem_446 ;
  RADIUS_PACKET **mem_447 ;
  unsigned int *mem_448 ;
  RADIUS_PACKET **mem_449 ;
  RADIUS_PACKET **mem_450 ;
  VALUE_PAIR **mem_451 ;
  uint32_t *mem_452 ;
  int *mem_453 ;
  RADIUS_PACKET **mem_454 ;
  VALUE_PAIR **mem_455 ;
  unsigned int *mem_456 ;
  RADIUS_PACKET **mem_457 ;
  VALUE_PAIR **mem_458 ;
  uint32_t *mem_459 ;
  uint32_t *mem_460 ;
  uint32_t *mem_461 ;
  unsigned int *mem_462 ;
  uint32_t *mem_463 ;
  RADIUS_PACKET **mem_464 ;
  RADIUS_PACKET **mem_465 ;
  unsigned int *mem_466 ;
  RADIUS_PACKET **mem_467 ;
  unsigned int *mem_468 ;
  RADIUS_PACKET **mem_469 ;
  VALUE_PAIR **mem_470 ;

  {
#line 438
  __cil_tmp31 = (void *)0;
#line 438
  tmp = (VALUE_PAIR *)__cil_tmp31;
#line 441
  __cil_tmp32 = (void *)0;
#line 441
  user_msg = (char const   *)__cil_tmp32;
#line 444
  autz_retry = (char)0;
#line 445
  autz_type = 0;
#line 447
  password = "";
  {
#line 459
  __cil_tmp33 = (unsigned long )request;
#line 459
  __cil_tmp34 = __cil_tmp33 + 32;
  {
#line 459
  mem_395 = (RADIUS_PACKET **)__cil_tmp34;
#line 459
  if (*mem_395) {
    {
#line 459
    __cil_tmp35 = (unsigned long )request;
#line 459
    __cil_tmp36 = __cil_tmp35 + 8;
#line 459
    mem_396 = (RADIUS_PACKET **)__cil_tmp36;
#line 459
    __cil_tmp37 = *mem_396;
#line 459
    __cil_tmp38 = (unsigned long )__cil_tmp37;
#line 459
    __cil_tmp39 = __cil_tmp38 + 52;
#line 459
    mem_397 = (unsigned int *)__cil_tmp39;
#line 459
    __cil_tmp40 = *mem_397;
#line 459
    if (__cil_tmp40 == 1U) {
      {
#line 461
      tmp = paircreate(1000, 1);
      }
      {
#line 462
      __cil_tmp41 = (void *)0;
#line 462
      __cil_tmp42 = (unsigned long )__cil_tmp41;
#line 462
      __cil_tmp43 = (unsigned long )tmp;
#line 462
      if (__cil_tmp43 == __cil_tmp42) {
        {
#line 463
        radlog(132, "no memory");
#line 464
        exit(1);
        }
      } else {

      }
      }
      {
#line 471
      __cil_tmp44 = (unsigned long )request;
#line 471
      __cil_tmp45 = __cil_tmp44 + 32;
#line 471
      mem_398 = (RADIUS_PACKET **)__cil_tmp45;
#line 471
      __cil_tmp46 = *mem_398;
#line 471
      __cil_tmp47 = (unsigned long )__cil_tmp46;
#line 471
      __cil_tmp48 = __cil_tmp47 + 52;
#line 471
      mem_399 = (unsigned int *)__cil_tmp48;
#line 471
      __cil_tmp49 = *mem_399;
#line 471
      if (__cil_tmp49 == 11U) {
#line 472
        __cil_tmp50 = (unsigned long )request;
#line 472
        __cil_tmp51 = __cil_tmp50 + 24;
#line 472
        mem_400 = (RADIUS_PACKET **)__cil_tmp51;
#line 472
        __cil_tmp52 = *mem_400;
#line 472
        __cil_tmp53 = (unsigned long )__cil_tmp52;
#line 472
        __cil_tmp54 = __cil_tmp53 + 52;
#line 472
        mem_401 = (unsigned int *)__cil_tmp54;
#line 472
        *mem_401 = 11U;
#line 473
        return (3);
      } else {

      }
      }
      {
#line 480
      __cil_tmp55 = (unsigned long )request;
#line 480
      __cil_tmp56 = __cil_tmp55 + 32;
#line 480
      mem_402 = (RADIUS_PACKET **)__cil_tmp56;
#line 480
      __cil_tmp57 = *mem_402;
#line 480
      __cil_tmp58 = (unsigned long )__cil_tmp57;
#line 480
      __cil_tmp59 = __cil_tmp58 + 52;
#line 480
      mem_403 = (unsigned int *)__cil_tmp59;
#line 480
      __cil_tmp60 = *mem_403;
#line 480
      if (__cil_tmp60 == 2U) {
#line 481
        __cil_tmp61 = (unsigned long )tmp;
#line 481
        __cil_tmp62 = __cil_tmp61 + 52;
#line 481
        mem_404 = (uint32_t *)__cil_tmp62;
#line 481
        *mem_404 = 254U;
      } else {
#line 483
        __cil_tmp63 = (unsigned long )tmp;
#line 483
        __cil_tmp64 = __cil_tmp63 + 52;
#line 483
        mem_405 = (uint32_t *)__cil_tmp64;
#line 483
        *mem_405 = 4U;
      }
      }
      {
#line 484
      __cil_tmp65 = (unsigned long )request;
#line 484
      __cil_tmp66 = __cil_tmp65 + 40;
#line 484
      __cil_tmp67 = (VALUE_PAIR **)__cil_tmp66;
#line 484
      pairadd(__cil_tmp67, tmp);
      }
      {
#line 492
      __cil_tmp68 = (unsigned long )request;
#line 492
      __cil_tmp69 = __cil_tmp68 + 32;
#line 492
      mem_406 = (RADIUS_PACKET **)__cil_tmp69;
#line 492
      __cil_tmp70 = *mem_406;
#line 492
      __cil_tmp71 = (unsigned long )__cil_tmp70;
#line 492
      __cil_tmp72 = __cil_tmp71 + 52;
#line 492
      mem_407 = (unsigned int *)__cil_tmp72;
#line 492
      __cil_tmp73 = *mem_407;
#line 492
      if (__cil_tmp73 != 2U) {
        {
#line 492
        __cil_tmp74 = (unsigned long )request;
#line 492
        __cil_tmp75 = __cil_tmp74 + 32;
#line 492
        mem_408 = (RADIUS_PACKET **)__cil_tmp75;
#line 492
        __cil_tmp76 = *mem_408;
#line 492
        __cil_tmp77 = (unsigned long )__cil_tmp76;
#line 492
        __cil_tmp78 = __cil_tmp77 + 52;
#line 492
        mem_409 = (unsigned int *)__cil_tmp78;
#line 492
        __cil_tmp79 = *mem_409;
#line 492
        if (__cil_tmp79 != 11U) {
          {
#line 494
          rad_authlog("Login incorrect (Home Server says so)", request, 0);
#line 495
          __cil_tmp80 = (unsigned long )request;
#line 495
          __cil_tmp81 = __cil_tmp80 + 24;
#line 495
          mem_410 = (RADIUS_PACKET **)__cil_tmp81;
#line 495
          __cil_tmp82 = *mem_410;
#line 495
          __cil_tmp83 = (unsigned long )__cil_tmp82;
#line 495
          __cil_tmp84 = __cil_tmp83 + 52;
#line 495
          mem_411 = (unsigned int *)__cil_tmp84;
#line 495
          *mem_411 = 3U;
#line 496
          rad_postauth_reject(request);
          }
#line 497
          return (0);
        } else {

        }
        }
      } else {

      }
      }
    } else {

    }
    }
  } else {

  }
  }
  }
#line 507
  __cil_tmp85 = (unsigned long )request;
#line 507
  __cil_tmp86 = __cil_tmp85 + 48;
#line 507
  mem_412 = (VALUE_PAIR **)__cil_tmp86;
#line 507
  namepair = *mem_412;
  {
#line 512
  __cil_tmp87 = (unsigned long )request;
#line 512
  __cil_tmp88 = __cil_tmp87 + 56;
#line 512
  mem_413 = (VALUE_PAIR **)__cil_tmp88;
#line 512
  __cil_tmp89 = *mem_413;
#line 512
  if (! __cil_tmp89) {
    {
#line 513
    __cil_tmp90 = (unsigned long )request;
#line 513
    __cil_tmp91 = __cil_tmp90 + 56;
#line 513
    __cil_tmp92 = (unsigned long )request;
#line 513
    __cil_tmp93 = __cil_tmp92 + 8;
#line 513
    mem_414 = (RADIUS_PACKET **)__cil_tmp93;
#line 513
    __cil_tmp94 = *mem_414;
#line 513
    __cil_tmp95 = (unsigned long )__cil_tmp94;
#line 513
    __cil_tmp96 = __cil_tmp95 + 104;
#line 513
    mem_415 = (VALUE_PAIR **)__cil_tmp96;
#line 513
    __cil_tmp97 = *mem_415;
#line 513
    mem_416 = (VALUE_PAIR **)__cil_tmp91;
#line 513
    *mem_416 = pairfind(__cil_tmp97, 2);
    }
  } else {

  }
  }
#line 520
  __cil_tmp98 = (unsigned long )request;
#line 520
  __cil_tmp99 = __cil_tmp98 + 56;
#line 520
  mem_417 = (VALUE_PAIR **)__cil_tmp99;
#line 520
  auth_item = *mem_417;
#line 521
  if (auth_item) {
#line 522
    __cil_tmp100 = 0 * 1UL;
#line 522
    __cil_tmp101 = 88 + __cil_tmp100;
#line 522
    __cil_tmp102 = (unsigned long )auth_item;
#line 522
    __cil_tmp103 = __cil_tmp102 + __cil_tmp101;
#line 522
    __cil_tmp104 = (uint8_t *)__cil_tmp103;
#line 522
    password = (char const   *)__cil_tmp104;
  } else {
    {
#line 528
    __cil_tmp105 = (unsigned long )request;
#line 528
    __cil_tmp106 = __cil_tmp105 + 8;
#line 528
    mem_418 = (RADIUS_PACKET **)__cil_tmp106;
#line 528
    __cil_tmp107 = *mem_418;
#line 528
    __cil_tmp108 = (unsigned long )__cil_tmp107;
#line 528
    __cil_tmp109 = __cil_tmp108 + 104;
#line 528
    mem_419 = (VALUE_PAIR **)__cil_tmp109;
#line 528
    __cil_tmp110 = *mem_419;
#line 528
    auth_item = pairfind(__cil_tmp110, 3);
    }
    {
#line 528
    __cil_tmp111 = (void *)0;
#line 528
    __cil_tmp112 = (unsigned long )__cil_tmp111;
#line 528
    __cil_tmp113 = (unsigned long )auth_item;
#line 528
    if (__cil_tmp113 != __cil_tmp112) {
#line 530
      password = "<CHAP-PASSWORD>";
    } else {
#line 536
      password = "<NO-PASSWORD>";
    }
    }
  }
#line 539
  __cil_tmp114 = (unsigned long )request;
#line 539
  __cil_tmp115 = __cil_tmp114 + 56;
#line 539
  mem_420 = (VALUE_PAIR **)__cil_tmp115;
#line 539
  *mem_420 = auth_item;
  autz_redo: 
  {
#line 545
  r = module_authorize(autz_type, request);
  }
#line 546
  if (r != 6) {
#line 546
    if (r != 7) {
#line 546
      if (r != 2) {
#line 546
        if (r != 8) {
#line 550
          if (r != 1) {
#line 550
            if (r != 3) {
              {
#line 551
              __cil_tmp116 = (unsigned long )request;
#line 551
              __cil_tmp117 = __cil_tmp116 + 8;
#line 551
              mem_421 = (RADIUS_PACKET **)__cil_tmp117;
#line 551
              __cil_tmp118 = *mem_421;
#line 551
              __cil_tmp119 = (unsigned long )__cil_tmp118;
#line 551
              __cil_tmp120 = __cil_tmp119 + 104;
#line 551
              mem_422 = (VALUE_PAIR **)__cil_tmp120;
#line 551
              __cil_tmp121 = *mem_422;
#line 551
              module_msg = pairfind(__cil_tmp121, 1076);
              }
              {
#line 551
              __cil_tmp122 = (void *)0;
#line 551
              __cil_tmp123 = (unsigned long )__cil_tmp122;
#line 551
              __cil_tmp124 = (unsigned long )module_msg;
#line 551
              if (__cil_tmp124 != __cil_tmp123) {
                {
#line 554
                __cil_tmp125 = 0 * 1UL;
#line 554
                __cil_tmp126 = (unsigned long )(msg) + __cil_tmp125;
#line 554
                __cil_tmp127 = (char *)__cil_tmp126;
#line 554
                __cil_tmp128 = (char * __restrict  )__cil_tmp127;
#line 554
                __cil_tmp129 = (char const   * __restrict  )"Invalid user (%s)";
#line 554
                __cil_tmp130 = 0 * 1UL;
#line 554
                __cil_tmp131 = 88 + __cil_tmp130;
#line 554
                __cil_tmp132 = (unsigned long )module_msg;
#line 554
                __cil_tmp133 = __cil_tmp132 + __cil_tmp131;
#line 554
                __cil_tmp134 = (uint8_t *)__cil_tmp133;
#line 554
                snprintf(__cil_tmp128, 270UL, __cil_tmp129, __cil_tmp134);
#line 556
                __cil_tmp135 = 0 * 1UL;
#line 556
                __cil_tmp136 = (unsigned long )(msg) + __cil_tmp135;
#line 556
                __cil_tmp137 = (char *)__cil_tmp136;
#line 556
                __cil_tmp138 = (char const   *)__cil_tmp137;
#line 556
                rad_authlog(__cil_tmp138, request, 0);
                }
              } else {
                {
#line 558
                rad_authlog("Invalid user", request, 0);
                }
              }
              }
#line 560
              __cil_tmp139 = (unsigned long )request;
#line 560
              __cil_tmp140 = __cil_tmp139 + 24;
#line 560
              mem_423 = (RADIUS_PACKET **)__cil_tmp140;
#line 560
              __cil_tmp141 = *mem_423;
#line 560
              __cil_tmp142 = (unsigned long )__cil_tmp141;
#line 560
              __cil_tmp143 = __cil_tmp142 + 52;
#line 560
              mem_424 = (unsigned int *)__cil_tmp143;
#line 560
              *mem_424 = 3U;
            } else {

            }
          } else {

          }
#line 562
          return (r);
        } else {

        }
      } else {

      }
    } else {

    }
  } else {

  }
#line 564
  if (! autz_retry) {
    {
#line 565
    __cil_tmp144 = (void *)0;
#line 565
    autz_type_item = (VALUE_PAIR *)__cil_tmp144;
#line 566
    __cil_tmp145 = (unsigned long )request;
#line 566
    __cil_tmp146 = __cil_tmp145 + 40;
#line 566
    mem_425 = (VALUE_PAIR **)__cil_tmp146;
#line 566
    __cil_tmp147 = *mem_425;
#line 566
    autz_type_item = pairfind(__cil_tmp147, 1011);
    }
#line 567
    if (autz_type_item) {
#line 568
      __cil_tmp148 = (unsigned long )autz_type_item;
#line 568
      __cil_tmp149 = __cil_tmp148 + 52;
#line 568
      mem_426 = (uint32_t *)__cil_tmp149;
#line 568
      __cil_tmp150 = *mem_426;
#line 568
      autz_type = (int )__cil_tmp150;
#line 569
      autz_retry = (char)1;
      goto autz_redo;
    } else {

    }
  } else {

  }
  {
#line 580
  __cil_tmp151 = (void *)0;
#line 580
  __cil_tmp152 = (unsigned long )__cil_tmp151;
#line 580
  __cil_tmp153 = (unsigned long )request;
#line 580
  __cil_tmp154 = __cil_tmp153 + 16;
#line 580
  mem_427 = (RADIUS_PACKET **)__cil_tmp154;
#line 580
  __cil_tmp155 = *mem_427;
#line 580
  __cil_tmp156 = (unsigned long )__cil_tmp155;
#line 580
  if (__cil_tmp156 == __cil_tmp152) {
    {
#line 580
    __cil_tmp157 = (unsigned long )request;
#line 580
    __cil_tmp158 = __cil_tmp157 + 40;
#line 580
    mem_428 = (VALUE_PAIR **)__cil_tmp158;
#line 580
    __cil_tmp159 = *mem_428;
#line 580
    tmp = pairfind(__cil_tmp159, 1048);
    }
    {
#line 580
    __cil_tmp160 = (void *)0;
#line 580
    __cil_tmp161 = (unsigned long )__cil_tmp160;
#line 580
    __cil_tmp162 = (unsigned long )tmp;
#line 580
    if (__cil_tmp162 != __cil_tmp161) {
      {
#line 588
      __cil_tmp163 = 0 * 1UL;
#line 588
      __cil_tmp164 = 88 + __cil_tmp163;
#line 588
      __cil_tmp165 = (unsigned long )tmp;
#line 588
      __cil_tmp166 = __cil_tmp165 + __cil_tmp164;
#line 588
      __cil_tmp167 = (uint8_t *)__cil_tmp166;
#line 588
      __cil_tmp168 = (char const   *)__cil_tmp167;
#line 588
      realm = realm_find(__cil_tmp168, 0);
      }
      {
#line 589
      __cil_tmp169 = (void *)0;
#line 589
      __cil_tmp170 = (unsigned long )__cil_tmp169;
#line 589
      __cil_tmp171 = (unsigned long )realm;
#line 589
      if (__cil_tmp171 == __cil_tmp170) {

      } else {
        {
#line 589
        __cil_tmp172 = (unsigned long )realm;
#line 589
        __cil_tmp173 = __cil_tmp172 + 192;
#line 589
        mem_429 = (int *)__cil_tmp173;
#line 589
        __cil_tmp174 = *mem_429;
#line 589
        if (__cil_tmp174 == 2) {

        } else {
          {
#line 589
          rad_assert_fail("auth.c", 589U);
          }
        }
        }
      }
      }
#line 590
      if (realm) {
        {
#line 590
        tmp___0 = htonl(4294967295U);
        }
        {
#line 590
        __cil_tmp175 = 192 + 4;
#line 590
        __cil_tmp176 = (unsigned long )realm;
#line 590
        __cil_tmp177 = __cil_tmp176 + __cil_tmp175;
#line 590
        mem_430 = (in_addr_t *)__cil_tmp177;
#line 590
        __cil_tmp178 = *mem_430;
#line 590
        if (__cil_tmp178 == tmp___0) {
#line 591
          if (debug_flag > 1) {
            {
#line 591
            __cil_tmp179 = 0 * 1UL;
#line 591
            __cil_tmp180 = 0 + __cil_tmp179;
#line 591
            __cil_tmp181 = (unsigned long )realm;
#line 591
            __cil_tmp182 = __cil_tmp181 + __cil_tmp180;
#line 591
            __cil_tmp183 = (char *)__cil_tmp182;
#line 591
            log_debug("  WARNING: You set Proxy-To-Realm = %s, but it is a LOCAL realm!  Cancelling invalid proxy request.",
                      __cil_tmp183);
            }
          } else {

          }
        } else {
#line 597
          return (2);
        }
        }
      } else {
#line 597
        return (2);
      }
    } else {

    }
    }
  } else {

  }
  }
#line 604
  __cil_tmp184 = (unsigned long )request;
#line 604
  __cil_tmp185 = __cil_tmp184 + 48;
#line 604
  mem_431 = (VALUE_PAIR **)__cil_tmp185;
#line 604
  namepair = *mem_431;
  {
#line 609
  while (1) {
    while_5_continue: /* CIL Label */ ;
    {
#line 610
    result = rad_check_password(request);
    }
#line 611
    if (result > 0) {
#line 613
      return (3);
    } else {

    }
    goto while_5_break;
  }
  while_5_break: /* CIL Label */ ;
  }
#line 624
  if (result < 0) {
#line 625
    if (debug_flag > 1) {
      {
#line 625
      log_debug("auth: Failed to validate the user.");
      }
    } else {

    }
    {
#line 626
    __cil_tmp186 = (unsigned long )request;
#line 626
    __cil_tmp187 = __cil_tmp186 + 24;
#line 626
    mem_432 = (RADIUS_PACKET **)__cil_tmp187;
#line 626
    __cil_tmp188 = *mem_432;
#line 626
    __cil_tmp189 = (unsigned long )__cil_tmp188;
#line 626
    __cil_tmp190 = __cil_tmp189 + 52;
#line 626
    mem_433 = (unsigned int *)__cil_tmp190;
#line 626
    *mem_433 = 3U;
#line 628
    __cil_tmp191 = (unsigned long )request;
#line 628
    __cil_tmp192 = __cil_tmp191 + 8;
#line 628
    mem_434 = (RADIUS_PACKET **)__cil_tmp192;
#line 628
    __cil_tmp193 = *mem_434;
#line 628
    __cil_tmp194 = (unsigned long )__cil_tmp193;
#line 628
    __cil_tmp195 = __cil_tmp194 + 104;
#line 628
    mem_435 = (VALUE_PAIR **)__cil_tmp195;
#line 628
    __cil_tmp196 = *mem_435;
#line 628
    module_msg = pairfind(__cil_tmp196, 1076);
    }
    {
#line 628
    __cil_tmp197 = (void *)0;
#line 628
    __cil_tmp198 = (unsigned long )__cil_tmp197;
#line 628
    __cil_tmp199 = (unsigned long )module_msg;
#line 628
    if (__cil_tmp199 != __cil_tmp198) {
      {
#line 631
      __cil_tmp200 = 0 * 1UL;
#line 631
      __cil_tmp201 = (unsigned long )(msg___0) + __cil_tmp200;
#line 631
      __cil_tmp202 = (char *)__cil_tmp201;
#line 631
      __cil_tmp203 = (char * __restrict  )__cil_tmp202;
#line 631
      __cil_tmp204 = (char const   * __restrict  )"Login incorrect (%s)";
#line 631
      __cil_tmp205 = 0 * 1UL;
#line 631
      __cil_tmp206 = 88 + __cil_tmp205;
#line 631
      __cil_tmp207 = (unsigned long )module_msg;
#line 631
      __cil_tmp208 = __cil_tmp207 + __cil_tmp206;
#line 631
      __cil_tmp209 = (uint8_t *)__cil_tmp208;
#line 631
      snprintf(__cil_tmp203, 273UL, __cil_tmp204, __cil_tmp209);
#line 633
      __cil_tmp210 = 0 * 1UL;
#line 633
      __cil_tmp211 = (unsigned long )(msg___0) + __cil_tmp210;
#line 633
      __cil_tmp212 = (char *)__cil_tmp211;
#line 633
      __cil_tmp213 = (char const   *)__cil_tmp212;
#line 633
      rad_authlog(__cil_tmp213, request, 0);
      }
    } else {
      {
#line 635
      rad_authlog("Login incorrect", request, 0);
      }
    }
    }
#line 639
    if (debug_flag > 1) {
      {
#line 639
      __cil_tmp214 = (void *)0;
#line 639
      __cil_tmp215 = (unsigned long )__cil_tmp214;
#line 639
      __cil_tmp216 = (unsigned long )auth_item;
#line 639
      if (__cil_tmp216 != __cil_tmp215) {
        {
#line 639
        __cil_tmp217 = (unsigned long )auth_item;
#line 639
        __cil_tmp218 = __cil_tmp217 + 40;
#line 639
        mem_436 = (int *)__cil_tmp218;
#line 639
        __cil_tmp219 = *mem_436;
#line 639
        if (__cil_tmp219 == 2) {
#line 643
          __cil_tmp220 = 0 * 1UL;
#line 643
          __cil_tmp221 = 88 + __cil_tmp220;
#line 643
          __cil_tmp222 = (unsigned long )auth_item;
#line 643
          __cil_tmp223 = __cil_tmp222 + __cil_tmp221;
#line 643
          p = (uint8_t *)__cil_tmp223;
          {
#line 644
          while (1) {
            while_6_continue: /* CIL Label */ ;
            {
#line 644
            __cil_tmp224 = *p;
#line 644
            __cil_tmp225 = (int )__cil_tmp224;
#line 644
            if (__cil_tmp225 != 0) {

            } else {
              goto while_6_break;
            }
            }
            {
#line 645
            tmp___1 = __ctype_b_loc();
            }
            {
#line 645
            __cil_tmp226 = *p;
#line 645
            __cil_tmp227 = (int )__cil_tmp226;
#line 645
            __cil_tmp228 = *tmp___1;
#line 645
            __cil_tmp229 = __cil_tmp228 + __cil_tmp227;
#line 645
            __cil_tmp230 = *__cil_tmp229;
#line 645
            __cil_tmp231 = (int const   )__cil_tmp230;
#line 645
            if (__cil_tmp231 & 16384) {

            } else {
              {
#line 646
              log_debug("  WARNING: Unprintable characters in the password.\n\t  Double-check the shared secret on the server and the NAS!");
              }
              goto while_6_break;
            }
            }
#line 649
            p = p + 1;
          }
          while_6_break: /* CIL Label */ ;
          }
        } else {

        }
        }
      } else {

      }
      }
    } else {

    }
  } else {

  }
#line 654
  if (result >= 0) {
    {
#line 654
    __cil_tmp232 = (unsigned long )request;
#line 654
    __cil_tmp233 = __cil_tmp232 + 40;
#line 654
    mem_437 = (VALUE_PAIR **)__cil_tmp233;
#line 654
    __cil_tmp234 = *mem_437;
#line 654
    check_item = pairfind(__cil_tmp234, 1034);
    }
    {
#line 654
    __cil_tmp235 = (void *)0;
#line 654
    __cil_tmp236 = (unsigned long )__cil_tmp235;
#line 654
    __cil_tmp237 = (unsigned long )check_item;
#line 654
    if (__cil_tmp237 != __cil_tmp236) {
      {
#line 657
      sess_type = 0;
#line 659
      __cil_tmp238 = (unsigned long )request;
#line 659
      __cil_tmp239 = __cil_tmp238 + 40;
#line 659
      mem_438 = (VALUE_PAIR **)__cil_tmp239;
#line 659
      __cil_tmp240 = *mem_438;
#line 659
      session_type = pairfind(__cil_tmp240, 1013);
      }
#line 660
      if (session_type) {
#line 661
        __cil_tmp241 = (unsigned long )session_type;
#line 661
        __cil_tmp242 = __cil_tmp241 + 52;
#line 661
        mem_439 = (uint32_t *)__cil_tmp242;
#line 661
        __cil_tmp243 = *mem_439;
#line 661
        sess_type = (int )__cil_tmp243;
      } else {

      }
#line 667
      if (namepair) {
        {
#line 667
        __cil_tmp244 = (unsigned long )check_item;
#line 667
        __cil_tmp245 = __cil_tmp244 + 52;
#line 667
        mem_440 = (uint32_t *)__cil_tmp245;
#line 667
        __cil_tmp246 = *mem_440;
#line 667
        __cil_tmp247 = (int )__cil_tmp246;
#line 667
        r = module_checksimul(sess_type, request, __cil_tmp247);
        }
#line 667
        if (r != 0) {
#line 669
          mpp_ok = (char)0;
#line 671
          if (r == 2) {
            {
#line 675
            __cil_tmp248 = (unsigned long )request;
#line 675
            __cil_tmp249 = __cil_tmp248 + 24;
#line 675
            mem_441 = (RADIUS_PACKET **)__cil_tmp249;
#line 675
            __cil_tmp250 = *mem_441;
#line 675
            __cil_tmp251 = (unsigned long )__cil_tmp250;
#line 675
            __cil_tmp252 = __cil_tmp251 + 104;
#line 675
            mem_442 = (VALUE_PAIR **)__cil_tmp252;
#line 675
            __cil_tmp253 = *mem_442;
#line 675
            port_limit = pairfind(__cil_tmp253, 62);
            }
            {
#line 675
            __cil_tmp254 = (void *)0;
#line 675
            __cil_tmp255 = (unsigned long )__cil_tmp254;
#line 675
            __cil_tmp256 = (unsigned long )port_limit;
#line 675
            if (__cil_tmp256 != __cil_tmp255) {
              {
#line 675
              __cil_tmp257 = (unsigned long )check_item;
#line 675
              __cil_tmp258 = __cil_tmp257 + 52;
#line 675
              mem_443 = (uint32_t *)__cil_tmp258;
#line 675
              __cil_tmp259 = *mem_443;
#line 675
              __cil_tmp260 = (unsigned long )port_limit;
#line 675
              __cil_tmp261 = __cil_tmp260 + 52;
#line 675
              mem_444 = (uint32_t *)__cil_tmp261;
#line 675
              __cil_tmp262 = *mem_444;
#line 675
              if (__cil_tmp262 > __cil_tmp259) {
#line 677
                if (debug_flag > 1) {
                  {
#line 677
                  log_debug("main auth: MPP is OK");
                  }
                } else {

                }
#line 678
                mpp_ok = (char)1;
              } else {

              }
              }
            } else {

            }
            }
          } else {

          }
#line 681
          if (! mpp_ok) {
            {
#line 682
            __cil_tmp263 = (unsigned long )check_item;
#line 682
            __cil_tmp264 = __cil_tmp263 + 52;
#line 682
            mem_445 = (uint32_t *)__cil_tmp264;
#line 682
            __cil_tmp265 = *mem_445;
#line 682
            if (__cil_tmp265 > 1U) {
              {
#line 683
              __cil_tmp266 = 0 * 1UL;
#line 683
              __cil_tmp267 = (unsigned long )(umsg) + __cil_tmp266;
#line 683
              __cil_tmp268 = (char *)__cil_tmp267;
#line 683
              __cil_tmp269 = (char * __restrict  )__cil_tmp268;
#line 683
              __cil_tmp270 = (char const   * __restrict  )"\r\nYou are already logged in %d times  - access denied\r\n\n";
#line 683
              __cil_tmp271 = (unsigned long )check_item;
#line 683
              __cil_tmp272 = __cil_tmp271 + 52;
#line 683
              mem_446 = (uint32_t *)__cil_tmp272;
#line 683
              __cil_tmp273 = *mem_446;
#line 683
              __cil_tmp274 = (int )__cil_tmp273;
#line 683
              snprintf(__cil_tmp269, 255UL, __cil_tmp270, __cil_tmp274);
#line 686
              __cil_tmp275 = 0 * 1UL;
#line 686
              __cil_tmp276 = (unsigned long )(umsg) + __cil_tmp275;
#line 686
              __cil_tmp277 = (char *)__cil_tmp276;
#line 686
              user_msg = (char const   *)__cil_tmp277;
              }
            } else {
#line 688
              user_msg = "\r\nYou are already logged in - access denied\r\n\n";
            }
            }
            {
#line 691
            __cil_tmp278 = (unsigned long )request;
#line 691
            __cil_tmp279 = __cil_tmp278 + 24;
#line 691
            mem_447 = (RADIUS_PACKET **)__cil_tmp279;
#line 691
            __cil_tmp280 = *mem_447;
#line 691
            __cil_tmp281 = (unsigned long )__cil_tmp280;
#line 691
            __cil_tmp282 = __cil_tmp281 + 52;
#line 691
            mem_448 = (unsigned int *)__cil_tmp282;
#line 691
            *mem_448 = 3U;
#line 697
            __cil_tmp283 = (unsigned long )request;
#line 697
            __cil_tmp284 = __cil_tmp283 + 24;
#line 697
            mem_449 = (RADIUS_PACKET **)__cil_tmp284;
#line 697
            __cil_tmp285 = *mem_449;
#line 697
            __cil_tmp286 = (unsigned long )__cil_tmp285;
#line 697
            __cil_tmp287 = __cil_tmp286 + 104;
#line 697
            __cil_tmp288 = (VALUE_PAIR **)__cil_tmp287;
#line 697
            pairfree(__cil_tmp288);
#line 698
            tmp = pairmake("Reply-Message", user_msg, 10);
#line 699
            __cil_tmp289 = (unsigned long )request;
#line 699
            __cil_tmp290 = __cil_tmp289 + 24;
#line 699
            mem_450 = (RADIUS_PACKET **)__cil_tmp290;
#line 699
            __cil_tmp291 = *mem_450;
#line 699
            __cil_tmp292 = (unsigned long )__cil_tmp291;
#line 699
            __cil_tmp293 = __cil_tmp292 + 104;
#line 699
            mem_451 = (VALUE_PAIR **)__cil_tmp293;
#line 699
            *mem_451 = tmp;
            }
#line 701
            if (r == 2) {
#line 701
              tmp___2 = "[MPP attempt]";
            } else {
#line 701
              tmp___2 = "";
            }
            {
#line 701
            __cil_tmp294 = 0 * 1UL;
#line 701
            __cil_tmp295 = (unsigned long )(logstr) + __cil_tmp294;
#line 701
            __cil_tmp296 = (char *)__cil_tmp295;
#line 701
            __cil_tmp297 = (char * __restrict  )__cil_tmp296;
#line 701
            __cil_tmp298 = (char const   * __restrict  )"Multiple logins (max %d) %s";
#line 701
            __cil_tmp299 = (unsigned long )check_item;
#line 701
            __cil_tmp300 = __cil_tmp299 + 52;
#line 701
            mem_452 = (uint32_t *)__cil_tmp300;
#line 701
            __cil_tmp301 = *mem_452;
#line 701
            snprintf(__cil_tmp297, 1024UL, __cil_tmp298, __cil_tmp301, tmp___2);
#line 704
            __cil_tmp302 = 0 * 1UL;
#line 704
            __cil_tmp303 = (unsigned long )(logstr) + __cil_tmp302;
#line 704
            __cil_tmp304 = (char *)__cil_tmp303;
#line 704
            __cil_tmp305 = (char const   *)__cil_tmp304;
#line 704
            rad_authlog(__cil_tmp305, request, 1);
#line 706
            result = -1;
            }
          } else {

          }
        } else {

        }
      } else {

      }
    } else {

    }
    }
  } else {

  }
#line 715
  if (result < 0) {
    {
#line 716
    rad_postauth_reject(request);
    }
#line 717
    return (0);
  } else {

  }
  {
#line 725
  __cil_tmp306 = (void *)0;
#line 725
  __cil_tmp307 = (unsigned long )__cil_tmp306;
#line 725
  __cil_tmp308 = (unsigned long )auth_item;
#line 725
  if (__cil_tmp308 != __cil_tmp307) {
    {
#line 725
    __cil_tmp309 = (unsigned long )auth_item;
#line 725
    __cil_tmp310 = __cil_tmp309 + 40;
#line 725
    mem_453 = (int *)__cil_tmp310;
#line 725
    __cil_tmp311 = *mem_453;
#line 725
    if (__cil_tmp311 == 3) {
#line 726
      password = "CHAP-Password";
    } else {

    }
    }
  } else {

  }
  }
  {
#line 733
  __cil_tmp312 = (unsigned long )request;
#line 733
  __cil_tmp313 = __cil_tmp312 + 24;
#line 733
  mem_454 = (RADIUS_PACKET **)__cil_tmp313;
#line 733
  __cil_tmp314 = *mem_454;
#line 733
  __cil_tmp315 = (unsigned long )__cil_tmp314;
#line 733
  __cil_tmp316 = __cil_tmp315 + 104;
#line 733
  mem_455 = (VALUE_PAIR **)__cil_tmp316;
#line 733
  __cil_tmp317 = *mem_455;
#line 733
  tmp = pairfind(__cil_tmp317, 8);
  }
  {
#line 733
  __cil_tmp318 = (void *)0;
#line 733
  __cil_tmp319 = (unsigned long )__cil_tmp318;
#line 733
  __cil_tmp320 = (unsigned long )tmp;
#line 733
  if (__cil_tmp320 != __cil_tmp319) {
    {
#line 733
    __cil_tmp321 = (unsigned long )tmp;
#line 733
    __cil_tmp322 = __cil_tmp321 + 344;
#line 733
    mem_456 = (unsigned int *)__cil_tmp322;
#line 733
    __cil_tmp323 = *mem_456;
#line 733
    if (__cil_tmp323 != 0U) {
      {
#line 741
      __cil_tmp324 = (unsigned long )request;
#line 741
      __cil_tmp325 = __cil_tmp324 + 8;
#line 741
      mem_457 = (RADIUS_PACKET **)__cil_tmp325;
#line 741
      __cil_tmp326 = *mem_457;
#line 741
      __cil_tmp327 = (unsigned long )__cil_tmp326;
#line 741
      __cil_tmp328 = __cil_tmp327 + 104;
#line 741
      mem_458 = (VALUE_PAIR **)__cil_tmp328;
#line 741
      __cil_tmp329 = *mem_458;
#line 741
      vpPortId = pairfind(__cil_tmp329, 5);
      }
      {
#line 741
      __cil_tmp330 = (void *)0;
#line 741
      __cil_tmp331 = (unsigned long )__cil_tmp330;
#line 741
      __cil_tmp332 = (unsigned long )vpPortId;
#line 741
      if (__cil_tmp332 != __cil_tmp331) {
        {
#line 743
        __cil_tmp333 = (unsigned long )tmp;
#line 743
        __cil_tmp334 = __cil_tmp333 + 52;
#line 743
        mem_459 = (uint32_t *)__cil_tmp334;
#line 743
        __cil_tmp335 = *mem_459;
#line 743
        tmp___3 = ntohl(__cil_tmp335);
#line 743
        tvalue = (unsigned long )tmp___3;
#line 744
        __cil_tmp336 = (unsigned long )tmp;
#line 744
        __cil_tmp337 = __cil_tmp336 + 52;
#line 744
        __cil_tmp338 = (unsigned long )vpPortId;
#line 744
        __cil_tmp339 = __cil_tmp338 + 52;
#line 744
        mem_460 = (uint32_t *)__cil_tmp339;
#line 744
        __cil_tmp340 = *mem_460;
#line 744
        __cil_tmp341 = (unsigned long )__cil_tmp340;
#line 744
        __cil_tmp342 = tvalue + __cil_tmp341;
#line 744
        __cil_tmp343 = (unsigned int )__cil_tmp342;
#line 744
        mem_461 = (uint32_t *)__cil_tmp337;
#line 744
        *mem_461 = htonl(__cil_tmp343);
#line 745
        __cil_tmp344 = (unsigned long )tmp;
#line 745
        __cil_tmp345 = __cil_tmp344 + 344;
#line 745
        mem_462 = (unsigned int *)__cil_tmp345;
#line 745
        *mem_462 = 0U;
#line 746
        __cil_tmp346 = 0 * 1UL;
#line 746
        __cil_tmp347 = 88 + __cil_tmp346;
#line 746
        __cil_tmp348 = (unsigned long )tmp;
#line 746
        __cil_tmp349 = __cil_tmp348 + __cil_tmp347;
#line 746
        __cil_tmp350 = (uint8_t *)__cil_tmp349;
#line 746
        __cil_tmp351 = (char *)__cil_tmp350;
#line 746
        __cil_tmp352 = (unsigned long )tmp;
#line 746
        __cil_tmp353 = __cil_tmp352 + 52;
#line 746
        mem_463 = (uint32_t *)__cil_tmp353;
#line 746
        __cil_tmp354 = *mem_463;
#line 746
        ip_ntoa(__cil_tmp351, __cil_tmp354);
        }
      } else {
#line 748
        if (debug_flag > 1) {
          {
#line 748
          log_debug("WARNING: No NAS-Port attribute in request.  CANNOT return a Framed-IP-Address + NAS-Port.\n");
          }
        } else {

        }
        {
#line 749
        __cil_tmp355 = (unsigned long )request;
#line 749
        __cil_tmp356 = __cil_tmp355 + 24;
#line 749
        mem_464 = (RADIUS_PACKET **)__cil_tmp356;
#line 749
        __cil_tmp357 = *mem_464;
#line 749
        __cil_tmp358 = (unsigned long )__cil_tmp357;
#line 749
        __cil_tmp359 = __cil_tmp358 + 104;
#line 749
        __cil_tmp360 = (VALUE_PAIR **)__cil_tmp359;
#line 749
        pairdelete(__cil_tmp360, 8);
        }
      }
      }
    } else {

    }
    }
  } else {

  }
  }
  {
#line 757
  __cil_tmp361 = (unsigned long )request;
#line 757
  __cil_tmp362 = __cil_tmp361 + 24;
#line 757
  mem_465 = (RADIUS_PACKET **)__cil_tmp362;
#line 757
  __cil_tmp363 = *mem_465;
#line 757
  __cil_tmp364 = (unsigned long )__cil_tmp363;
#line 757
  __cil_tmp365 = __cil_tmp364 + 52;
#line 757
  mem_466 = (unsigned int *)__cil_tmp365;
#line 757
  __cil_tmp366 = *mem_466;
#line 757
  if (__cil_tmp366 == 0U) {
#line 758
    __cil_tmp367 = (unsigned long )request;
#line 758
    __cil_tmp368 = __cil_tmp367 + 24;
#line 758
    mem_467 = (RADIUS_PACKET **)__cil_tmp368;
#line 758
    __cil_tmp369 = *mem_467;
#line 758
    __cil_tmp370 = (unsigned long )__cil_tmp369;
#line 758
    __cil_tmp371 = __cil_tmp370 + 52;
#line 758
    mem_468 = (unsigned int *)__cil_tmp371;
#line 758
    *mem_468 = 2U;
  } else {

  }
  }
  {
#line 760
  __cil_tmp372 = (unsigned long )request;
#line 760
  __cil_tmp373 = __cil_tmp372 + 8;
#line 760
  mem_469 = (RADIUS_PACKET **)__cil_tmp373;
#line 760
  __cil_tmp374 = *mem_469;
#line 760
  __cil_tmp375 = (unsigned long )__cil_tmp374;
#line 760
  __cil_tmp376 = __cil_tmp375 + 104;
#line 760
  mem_470 = (VALUE_PAIR **)__cil_tmp376;
#line 760
  __cil_tmp377 = *mem_470;
#line 760
  module_msg = pairfind(__cil_tmp377, 1075);
  }
  {
#line 760
  __cil_tmp378 = (void *)0;
#line 760
  __cil_tmp379 = (unsigned long )__cil_tmp378;
#line 760
  __cil_tmp380 = (unsigned long )module_msg;
#line 760
  if (__cil_tmp380 != __cil_tmp379) {
    {
#line 763
    __cil_tmp381 = 0 * 1UL;
#line 763
    __cil_tmp382 = (unsigned long )(msg___1) + __cil_tmp381;
#line 763
    __cil_tmp383 = (char *)__cil_tmp382;
#line 763
    __cil_tmp384 = (char * __restrict  )__cil_tmp383;
#line 763
    __cil_tmp385 = (char const   * __restrict  )"Login OK (%s)";
#line 763
    __cil_tmp386 = 0 * 1UL;
#line 763
    __cil_tmp387 = 88 + __cil_tmp386;
#line 763
    __cil_tmp388 = (unsigned long )module_msg;
#line 763
    __cil_tmp389 = __cil_tmp388 + __cil_tmp387;
#line 763
    __cil_tmp390 = (uint8_t *)__cil_tmp389;
#line 763
    snprintf(__cil_tmp384, 266UL, __cil_tmp385, __cil_tmp390);
#line 765
    __cil_tmp391 = 0 * 1UL;
#line 765
    __cil_tmp392 = (unsigned long )(msg___1) + __cil_tmp391;
#line 765
    __cil_tmp393 = (char *)__cil_tmp392;
#line 765
    __cil_tmp394 = (char const   *)__cil_tmp393;
#line 765
    rad_authlog(__cil_tmp394, request, 1);
    }
  } else {
    {
#line 767
    rad_authlog("Login OK", request, 1);
    }
  }
  }
  {
#line 773
  result = rad_postauth(request);
  }
#line 775
  return (result);
}
}
